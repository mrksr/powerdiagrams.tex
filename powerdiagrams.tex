\input{preamble.tex}
\input{tikzpictures.tex}

\title{Incidence Structures of Power Diagrams}
\subtitle{Interdisciplinary Project}
\author{%
    \texorpdfstring{Markus Kaiser\\\href{mailto:markus.kaiser@in.tum.de}{markus.kaiser@in.tum.de}}{Markus Kaiser}}
\publishers{Technische Universität München}

\begin{document}
\maketitle
\begin{abstract}
    \blindtext
\end{abstract}
\tableofcontents

\section{Introduction}
\label{sec:introduction}
\todo[inline]{Was sind Powerdiagramme}
\todo[inline]{Wozu Powerdiagramme}
\todo[inline]{Inzidenzstruktur}
\todo[inline]{Clustering für hochdimensionale Daten}
\todo[inline]{Metalllegierungen}
\todo[inline]{http://www-m9.ma.tum.de/Allgemeines/AndreasAlpersPublications}

\section{Power Diagrams}
\label{sec:powerdiagrams}

Power diagrams in $d$-dimensional Euclidean space $\R^d$ can be understood as a particular generalization of the more well known Voronoi diagrams.
A \define{Voronoi diagram} is a cell decomposition of the space introduced by a finite set of points $M \subset \R^d$ and a metric $\dist(\cdot, \cdot)$.
It assigns every point $p \in M$ its \define{region} of points for which there is no point closer than $p$ in $M$.
Using the euclidean metric, these regions are guaranteed to be polyhedra.
The normal vectors of the hyperplanes at the boundaries are given by the connecting line of neighbouring points with the hyperplane bisecting this line.
\begin{figure}[Htb]
    \centering
    \begin{tikzpicture}
        \path[clip, use as bounding box] (-3, 0) rectangle (7, 4);

        \node[sphere center, label={$4$}] (s0) at (     5.0,     3.0) {};
        \node[sphere center, label={above right:$6$}] (s1) at (     5.5,     1.0) {};
        \node[sphere center, label={$1$}] (s2) at (    -1.0,     2.0) {};
        \node[sphere center, label={$2$}] (s3) at (     1.0,     1.0) {};
        \node[sphere center, label={$3$}] (s4) at (     1.0,     3.0) {};
        \node[sphere center, label={$5$}] (s5) at (     3.0,     1.0) {};

        \coordinate (p0) at (    0.25,     2.0);
        \coordinate (p1) at (    4.25,    1.75);
        \coordinate (p2) at (     3.0,     3.0);
        \coordinate (p3) at (     2.0,     2.0);

        \draw[thin]
            (s5) edge (s0)
            (s5) edge (s1)
            (s0) edge (s1);
        \draw[right angle length=1.5ex, right angle symbol={s5}{s0}{p1}];
        \draw[right angle length=1.5ex, right angle symbol={s5}{s1}{p1}];
        \draw[right angle length=1.5ex, right angle symbol={s1}{s0}{p1}];

        \draw[extremal edge] (p0) edge node[extremal spheres] {${1, 2}$} ($(p0) + 10*( -0.4472, -0.8944)$);
        \draw[extremal edge] (p0) edge node[extremal spheres] {${1, 3}$} ($(p0) + 10*( -0.4472,  0.8944)$);
        \draw[internal edge] (p0) edge node[internal spheres] {${2, 3}$} (p3);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${4, 6}$} ($(p1) + 10*(  0.9701,  0.2425)$);
        \draw[extremal edge] (p1) edge node[extremal spheres] {${5, 6}$} ($(p1) + 10*(    -0.0,    -1.0)$);
        \draw[internal edge] (p1) edge node[internal spheres] {${4, 5}$} (p2);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.05] {${3, 4}$} ($(p2) + 10*(     0.0,     1.0)$);
        \draw[internal edge] (p2) edge node[internal spheres] {${3, 5}$} (p3);
        \draw[extremal edge] (p3) edge node[extremal spheres] {${2, 5}$} ($(p3) + 10*(     0.0,    -1.0)$);

        \node[point] () at (p0) {};
        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
        \node[point] () at (p3) {};
    \end{tikzpicture}
    \caption{2D-Voronoi diagrams partition the plane into regions of points with a common closest input point. The edges separating two regions can be calculated as the perpendicular bisector of the line connecting their centers. Two regions are neighbours if there exists an edge between their points in the Delaunay triangulation of the same set.}
    \label{fig:voronoi}
\end{figure}

\cref{fig:voronoi} shows an example of a Voronoi diagram in $d = 2$ dimensions.
While obtaining the hyperplanes which potentially separate the regions is easy, it must identified which of them actually exist, since not every region is a neighbour of every other region.
It can be shown \cite{aurenhammer1991voronoi} that there exists a dual relationship between Voronoi diagrams in two dimensions and Delaunay triangulations.
A \define{Delaunay triangulation} of a set of points $M$ is a graph in which three points are connected exactly if the smallest circle containing all three points does not contain any other point in $M$.
Two regions in the Voronoi diagram then are neighbours exactly if there exists an edge in the Delaunay triangulation between their corresponding points.

This gives rise to efficient algorithms for constructing the diagrams, since the triangulations can be obtained in $\Oh(n \log n)$ time by incrementally inserting points in an existing triangulation.
This algorithm was first described by Green and Sibson \cite{green1978computing} and is optimal, since one can reduce the sorting problem to finding triangulations \cite{aurenhammer1991voronoi}.
Another algorithm to find Delauny triangulation described by Aurenhammer involves lifting the two dimensional input into three dimensions by projecting it to a paraboloid.
The triangulation can then be found by computing the lower convex hull of those points, also yielding $\Oh(n \log n)$ complexity in two dimensions.

This paper will introduce a generalization of Voronoi diagrams called power diagrams.
After introducing the necessary notation, a dual relationship between these power diagrams in $d$ dimensions and polyhedra in $d+1$ dimensions will be proven.
This allows the adaptation of the aforementioned algorithm and shows its correctness in arbitrary dimensions $d \geq 1$.
Lastly, a concrete implementation of this algorithm and the needed data structures is described.

\subsection{Definition of Power Diagrams}
\label{sub:definition_of_power_diagrams}
There are multiple possible modifications of Voronoi diagrams, a few of which are decribed in \cite{aurenhammer1987power}.
To obtain \define{power diagrams}, each point $p \in M$ is assigned a \define{weight} $w(p)$, where a larger weight results in a larger cell.
The distance function of a point $x \in \R^d$ and one weighted point $p$ is then given by $\dist(x, p)^2 - w(p)$.
While other possible combinations of distance and weight have also been investigated \cite{aurenhammer1987power}, this definition has a connection to the power of circles around the points $p \in M$.

\begin{definition}[Power of a Point]
    \label{def:power}
    The \define{power} of a point $x \in \R^d$ with respect to a sphere $s = (p, r^2)$ with center $p \in \R^d$ and radius $r \in \R$ is given by
    \begin{align}
        \pow(x, s) = \dist(x, p)^2 - r^2.
    \end{align}
\end{definition}
\begin{figure}[tb]
    \centering
    \begin{subfigure}[b]{.35\linewidth}
        \begin{tikzpicture}[x=1cm, y=1cm]
            \coordinate (center) at (0, 0);
            \coordinate (point) at (2, 3);

            \node[power circle, minimum size=3cm, label={[yshift=0.5cm]below:$s$}] (circle) at (center) {};

            \coordinate (tangent) at (tangent cs:node=circle,point={(point)},solution=1);

            \draw[right angle length=1.5ex, right angle symbol={center}{tangent}{point}];

            \draw
                (tangent) edge[black] node[midway, left] {$r$} (center.center)
                (center.center) edge[black] node[pos=0.6, sloped, below] {$\dist(x, p)$} (point)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s)$} (tangent);
            \draw
                (center)
                node[power center, label={below:$p$}] () {}

                (point)
                node[power point, label={above:$x$}] () {};
        \end{tikzpicture}
        \caption{Interpretation of $\pow$}
        \label{sfig:pow_interpretation}
    \end{subfigure}
    \begin{subfigure}[b]{.55\linewidth}
        \begin{tikzpicture}[x=1cm, y=1cm]
            \coordinate (center-a) at (-2, 0);
            \coordinate (center-b) at (2, 0);
            \coordinate (point) at (0.46875, 3);

            \node[power circle, minimum size=4cm] (circle-a) at (center-a) {};
            \node[power circle, minimum size=1cm] (circle-b) at (center-b) {};

            \coordinate (tangent-a) at (tangent cs:node=circle-a,point={(point)},solution=1);
            \coordinate (tangent-b) at (tangent cs:node=circle-b,point={(point)},solution=2);

            \draw[right angle length=1.5ex, right angle symbol={center-a}{center-b}{point}];

            \draw
                (center-a.center) edge (center-b.center)
                (point) +(0, 1) edge[very thick, tumgreen] (point |- 0, -2cm)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s_1)$} (tangent-a)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s_2)$} (tangent-b);

            \draw
                (center-a)
                node[power center, label={below:$p_1$}] () {}
                (center-b)
                node[power center, label={below:$p_2$}] () {}

                (point)
                node[power point, label={above right:$x$}] () {};
        \end{tikzpicture}
        \caption{Equality of powers of two spheres}
        \label{sfig:chordal}
    \end{subfigure}
    \caption{\Cref{def:power} has a nice geometric interpretation for points $x$ lying outside of the sphere $s=(p, r)$. The power $\pow(x, s) = \dist(x, p)^2 - r^2$ can be interpreted as the length of a tangent of point $p$ to the sphere $s$. When comparing the powers of two non-intersecting spheres $s_1, s_2$, the set of points $x$ for which $\pow(x, s_1) = \pow(x, s_2)$ is a hyperplane perpendicular to the line connecting the two centers but not necessarily its bisector.}
    \label{fig:power}
\end{figure}

The power function was -- for example -- mentioned at the beginning of the 19th century by Steiner \cite{steiner1881jacob} and Laguerre \cite{blaschke2013vorlesungen} as a measure of the relationship of a point to a circle.
A point has a negative power if inside, a positive power if outside and its power vanishes if it lies on the circle.
Using the Pythagorean theorem, this function has a geometric interpretation shown in \cref{fig:power}.

Using this definition, a pair $s = (p, w(p))$ of a point and its weight is called a \define{site} of the power diagram, which can be interpreted as a sphere with a radius of $\sqrt{w(p)}$.
Every such site gets assigned its partition of the space where there is no other site with lower power.
\begin{figure}[tb]
    \centering
    \begin{tikzpicture}
        \path[clip, use as bounding box] (-6, -2.05) rectangle (7, 4.05);

        \node[sphere center, label={above:$s_1$}] (s1) at (     2.0,     3.0) {};
        \draw[sphere radius] (s1) circle[radius=1.0];
        \node[sphere center, label={above:$s_5$}] (s2) at (     5.0,     0.0) {};
        \draw[sphere radius] (s2) circle[radius=1.0];
        \node[sphere center, label={above:$s_3$}] (s3) at (    -2.0,     0.0) {};
        \draw[sphere radius] (s3) circle[radius=3.0];
        \node[sphere center, label={above:$s_4$}] (s4) at (     2.0,     0.0) {};
        \draw[sphere radius] (s4) circle[radius=2.0];
        \node[sphere center, label={above:$s_2$}] (s5) at (     4.0,     2.0) {};
        \draw[sphere radius] (s5) circle[radius=1.0];

        \coordinate (p1) at (   0.625,     2.0);
        \coordinate (p2) at (     4.0,    0.75);
        \coordinate (p3) at (    2.75,     2.0);

        \draw[thin] (s4) edge (s2);
        \draw[right angle length=1.5ex, right angle symbol={s4}{s2}{p2}];
        % \draw[thin]
        %     (s4) edge (s5)
        %     (s4) edge (s2)
        %     (s2) edge (s5);
        % \draw[right angle length=1.5ex, right angle symbol={s4}{s5}{p2}];
        % \draw[right angle length=1.5ex, right angle symbol={s4}{s2}{p2}];
        % \draw[right angle length=1.5ex, right angle symbol={s2}{s5}{p2}];

        \draw[extremal edge] (p1) edge node[extremal spheres] {${1, 3}$} ($(p1) + 10*(    -0.6,     0.8)$);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${3, 4}$} ($(p1) + 10*(     0.0,    -1.0)$);
        \draw[internal edge] (p1) edge node[internal spheres, pos=0.2] {${1, 4}$} (p3);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.2] {${4, 5}$} ($(p2) + 10*(    -0.0,    -1.0)$);
        \draw[extremal edge] (p2) edge node[extremal spheres] {${2, 5}$} ($(p2) + 10*(  0.8944,  0.4472)$);
        \draw[internal edge] (p2) edge node[internal spheres, pos=0.5] {${2, 4}$} (p3);
        \draw[extremal edge] (p3) edge node[extremal spheres] {${1, 2}$} ($(p3) + 10*(  0.4472,  0.8944)$);

        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
        \node[point] () at (p3) {};
    \end{tikzpicture}
    \caption{The power diagram of the five sites $\PD(\left\{ s_1, \dots, s_5 \right\})$ is the set of their cells, whose boundaries are shown in the figure. Boundaries are defined by sets of points for which adjacent sites have equal minimizing power.}
    \label{fig:garage}
\end{figure}

\begin{definition}[Power Diagram]
    \label{def:powerdiagram}
    The \define{power diagram} $\PD(S)$ of a finite set of sites $S = \left\{ s_1, \dots, s_n \right\} \subset \R^d \times \R_{\geq 0}$ is a tuple of all \define{cells} corresponding to the sites.
    \begin{align}
        \cell_S &: \begin{cases}
            S &\to \powerset{\R^d}\\
            s &\mapsto \left\{ x \in \R^d \mid \forall t \in S \setminus \left\{ s \right\}: \pow(x, s) \leq \pow(x, t) \right\}
        \end{cases}\\
        \PD(\left\{ s_1, \dots, s_n \right\}) &\coloneqq \left( \cell_S(s_1), \dots, \cell_S(s_n) \right)
    \end{align}
\end{definition}

\Cref{fig:garage} shows an example of a power diagram in two dimensions.
After introducing some geometric notation, the remainder of this section will show some properties of power diagrams in $d$ dimensions.
After this, a transform to $d + 1$ dimensions will be used to both show a fundamental connection between power diagrams and polyhedra and derive an algorithm to efficiently construct power diagrams of arbitrary dimension using convex hulls.

\subsection{Geometric Notation}
\label{sub:geometric_notation}
Like Voronoi diagrams, power diagrams will be shown to consist of polyhedral regions, which share faces at their boundaries.
An extensive introduction into polyhedra can be found in \cite{grunbaum2003convex} by Grünbaum and an introduction into convex analysis is given by Gritzmann in \cite{gritzmann2013grundlagen}.
The following will repeat some notations of \cite{aurenhammer1987power}.

Let $n \in \R^d$ with $n \neq 0$ and let $b \in \R$.
Then $h = \left\{ x \in \R^d \mid n^T x = b \right\}$ is a \define{hyperplane} and $h^+ = \left\{ x \in \R^d \mid n^T x \geq b \right\}$ is an \define{(closed) upper halfspace} in $\R^d$.
A $j$-flat $f$ is a a set expressible as the intersection of $d - j$, but no fewer, hyperplanes.
It is an affine subspace of $\R^d$ with dimensionality $j$ and is expressible as the affine hull of $j + 1$ linearly independent points in $f$.

A set $P \subseteq R^d$ is called a \define{polyhedron} exactly if it is expressible as the intersection of a finite number of halfspaces.
$P$ is a \define{$j$-polyhedron} if there is a $j$-flat, but no $(j-1)$-flat that contains $P$.
The boundary of $P$ consists of a finite number of $i$-polyhedra with $0 \leq i < j \leq d$, which are called the \define{$i$-faces} of $P$.
$0$-, $1-$ and $(j - 1)$-faces are called \define{vertex}, \define{edge} and \define{facet} respectively.
$P$ is called a \define{polytope} if it is bounded and can then also be expressed as the \define{convex hull $\CH$} of its $0$-faces.

Two $d$-polyhedra $P$ and $Q$ are called \define{(combinatorically) dual} if there is a bijection $\varphi$ from the $j$-faces of $P$ and the $(d-j-1)$-faces of $Q$ for $0 \leq j \leq d  -1$ such that $f \subseteq g$ for any two faces $f$ and $g$ of $P$ exactly if $\varphi(f) \supseteq \varphi(g)$.

A convex hull can be separated into the upper and lower part with respect to some vector $v \neq 0$.
A facet of the convex hull with normal vector $n$ is part of the \define{lower convex hull $\CHb$} if $\scalar{n, v} < 0$ and part of the \define{upper convex hull $\CHt$} if $\scalar{n, v} > 0$.
All other facets are not part of either.
Any other face is in the lower or upper convex hull if it is contained in a facet which is in $\CHb$ or $\CHt$ repsectively.

A \define{cell decomposition $C$} of $\R^d$ is a finite family of polyhedra for which every face of a polytope in $C$ is itself a member of $C$ and for which a non-empty intersection of any two members of $C$ is a face of each of them, together with $\bigcup_{f \in C} f = \R^d$.
$d$-faces of $C$ are called \define{cells}.
$C$ and a $(d+1)$-polyhedron $P$ are called \define{affinely equivalent} if there exists a central or parallel projection $\varphi$ such that for every face $f \in C$, $f = \varphi(g)$ holds for some face $g$ of $P$.

\subsection{Properties of Power Diagrams}
\label{sub:properties_of_power_diagrams}
The boundaries of a power diagram are given by sets of points for which the power of at least two sites is equal.
Using the definition of the power function, it can be shown that these boundaries are hyperplanes.
\begin{observation}
    \label{obs:chordale}
    Let $s = (z_s, r^2_s)$ and $t = (z_t, r^2_t)$ be spheres in $\R^d$ with $z_s \neq z_t$. The points $x$ for which $\pow(x, s) = \pow(x, t)$ are called the \define{chordale} of $s$ and $t$ and form the hyperplane
    \begin{align}
        \chor(s, t) = \left\{ x \in \R^d \mid 2(z_s - z_t)^Tx = r_t^2 - r_s^2 - z_t^Tz_t + z_s^Tz_s \right\}
    \end{align}
    which is perpendicular to the line connecting $z_s$ and $z_t$.
\end{observation}

The chordal of two concentric spheres is not defined, but can be assumed to be at infinity.
Note that if $r_s = r_t$, the chordal of the two spheres is the bisector of the line connecting $z_s$ and $z_t$.
A power diagram for which all radii are equal is therefore equivalent to the Voronoi diagram of the centers.

The normal vectors of the chordales of three spheres are given by the pairwise differences of their centers.
Since any of these differences can be expressed through the other two, their intersection has higher dimensionality than a general intersection of three hyperplanes has.
\begin{observation}
    \label{obs:cellsarepolyhedra}
    Let $s, t$ and $u$ be spheres in $\R^d$ with $d \geq 2$.
    If the spheres are not collinear, the intersection of their chordales $\chor(s,t) \cap \chor(t, u) \cap \chor(u, s)$ is a $(d-2)$-flat.
    If they are collinear, the three chordales are parallel.
    More generally, the chordales of a sphere with $k \leq d$ non-collinear other spheres in $\R^d$ intersect in a $(d-k)$-flat.
\end{observation}

Let $S$ be a finite set of $n$ spheres in $\R^d$ whose centers have an affine dimension of $d$.
Since the cell of every sphere $s \in S$ is bounded by $n - 1$ chordales (which are not necessarily all part of the power diagram), it can be expressed as the intersection of $n - 1$ halfspaces and is therefore a $d$-polyhedron.
Together with the fact that every $x \in \R^d$ is part of some cell of $\PD(S)$ by definition, this shows that $\PD(S)$ is a cell decomposition of $\R^d$.

\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[x=0.5cm, y=0.5cm]
        \path[clip, use as bounding box] (-5, -7) rectangle (19, 8);

        \node[sphere center, label={above:$s_5$}] (s1) at (    10.0,     4.0) {};
        \draw[sphere radius] (s1) circle[radius=3.5];
        \node[sphere center, label={right:$s_3$}] (s2) at (    15.0,    -3.0) {};
        \draw[sphere radius] (s2) circle[radius=3.2];
        \node[sphere center, label={left:$s_1$}] (s3) at (     0.0,     0.0) {};
        \draw[sphere radius] (s3) circle[radius=5.0];
        \node[sphere center, label={above:$s_4$}] (s4) at (    13.5,    -3.0) {};
        \draw[sphere radius] (s4) circle[radius=1.3];
        \node[sphere center, label={above:$s_2$}] (s5) at (    1.7,    0) {};
        \draw[sphere radius] (s5) circle[radius=1.5];

        \coordinate (p1) at (   7.408,  -2.425);
        \coordinate (p2) at (    11.4, -0.4293);

        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.3] {${1, 5}$} ($(p1) + 15*( -0.3714,  0.9285)$);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${1, 4}$} ($(p1) + 15*( -0.2169, -0.9762)$);
        \draw[internal edge] (p1) edge node[internal spheres] {${4, 5}$} (p2);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.3] {${3, 5}$} ($(p2) + 15*(  0.8137,  0.5812)$);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.3] {${3, 4}$} ($(p2) + 15*(    -0.0,    -1.0)$);

        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
    \end{tikzpicture}
    \caption{The cell of site $s_2$ in this two-dimensional power diagram with five sites is empty. This can happen, if the sphere of a site is completely contained in a sphere of an other site. This condition is not sufficient however, since $s_4$ does have a non-empty cell. The center of $s_4$ is not part of its cell however.}
    \label{fig:emptycells}
\end{figure}
\Cref{fig:emptycells} shows that in contrast to Voronoi diagrams, not every sphere must have a non-empty cell in a power diagram.
This can happen, if a sphere completely contained in another sphere, but this is not a sufficient condition.
Being contained in another sphere can also lead to a sphere $s$ having a cell for which $z_s \not\in \cell(s) \neq \varnothing$.

While it is easy to calculate chordales for two spheres, the main question to answer when constructing power diagrams is which chordales actually are tight bounds to a cell and which $j$-faces (for $0 \leq j < d - 1$) shared by which neighbouring cells exist.
To describe all existing non-extremal faces, one can find all $0$-faces and remember which sets of them describe the existing faces of higher dimensionality via their convex hulls.
To justify this approach, the following lemma shows that for power diagrams which have $0$-faces, this approach does not miss non-extremal faces.

\begin{lemma}
    \label{lem:zerofaces}
    Let $S \subset \R^d$ be a finite set of spheres.
    If any cell of $\PD(S)$ is bounded by a $0$-face, then every cell in $\PD(S)$ is bounded by a $0$-face.
\end{lemma}
\begin{proof}
    Let $S \subset \R^d$ be a finite set of spheres $s_i = (z_i, r_i^2)$ with $\abs{S} \geq d+2$ and $s_1, \dots, s_d, s_{d+1}, s_{d+2} \in S$ such that (the cell of) $s_{d+1}$ shares a $0$-face with $s_1, \dots, s_d$ in $\PD(S)$.
    Since the chordales of $z_{d+1}$ with these sites intersect in a $0$-face, their $d$ normal vectors $\left\{  z_i - z_{d+1} \mid 1 \leq i \leq d\right\}$ must be linearly independent, or equivalently, $\dim(\aff(\left\{ z_1, z_2, \dots, z_{d+1} \right\})) = d$.

    Suppose that $z_{d+2}$ is not bounded by a $0$-face.
    Then, the face of lowest dimension of the polyhedron of $s_{d+2}$ has at least $1$ dimension and must be unbounded, giving the polyhedron a lineality space of dimensionality at least $1$.

    The vectors in this lineality space must be perpendicular to all chordales of $s_{d+2}$, since the polyhedron is bounded by them.
    A subset of the normal vectors of these chordales is the set $C = \left\{ z_i - z_{d+2} \mid 1 \leq i \leq d+1 \right\}$.
    Note that
    \begin{align}
        \dim C = \dim \left( \aff \left( \left\{ z_1, z_2, \dots, z_{d+2} \right\} \right) \right) \geq \dim \left( \aff \left( \left\{ z_1, z_2, \dots, z_{d+1} \right\} \right) \right) = d
    \end{align}
    and therefore, the lineality space can only have dimension $0$, which is a contradiction.
\end{proof}

\section{Embedding in \texorpdfstring{$d+1$}{d+1} Dimensions}
\label{sec:embedding_in_d_1_dimensions}
To derive an algorithm to efficiently compute the cells of power diagrams via the incidence structure of the faces of the boundaries, power diagrams of $d$ dimensions will be embedded into $d+1$ dimensions using a transformation function to map its spheres to hyperplanes.
This will lead to a result identifying these power diagrams with polyhedra in $d+1$ dimensions which can be expressed as the intersection of upper halfspaces.
Using this identity together with a duality mapping for polyhedra will finally connect power diagrams to convex hulls and will be the basis of the algorithm to calculate power diagrams.

\subsection{The Transformation Function}
\label{sub:the_transform}
The embedding of power diagrams in an additional dimension relies on the fact that the power function of a sphere in $\R^d$ can be calculated using distances to a hyperplane in $\R^{d+1}$.

Inspect the space $\R^{d+1}$ and let the original space $\R^d$ be identified with the hyperplane $h_0: x_{d+1} = 0$.
Let $\Ha$ be the set of all hyperplanes not parallel to the $x_{d+1}$ axis
\begin{align}
    \Ha &\coloneqq \left\{ h \subseteq \R^{d+1} \mid \exists a \in \R^d, a_{d+1} \in \R : x \in h \Leftrightarrow x_{d+1} = a^Tx_{[d]} + a_{d+1} \right\}
\end{align}
with $h_0 \in \Ha$.
Lastly let $U$ denote the paraboloid $x_{d+1} = x_{[d]}^Tx_{[d]}$ with $x_{[d]} = \left( x_1, \dots, x_d \right)^T$.

\begin{definition}[Transformation Function]
    The \define{transformation function $\Pi$} maps spheres in $h_0$ to hyperplanes in $\R^{d+1}$.
    \begin{align}
        \Pi: \left\{\begin{aligned}
            \R^{d} \times \R_{\geq 0} &\to \Ha\\
            (z, r^2) &\mapsto \left\{ x \in \R^{d+1} \mid x_{d+1} = 2x_{[d]}^Tz - z^Tz + r^2 \right\}
        \end{aligned}\right.
    \end{align}
\end{definition}

This transform has a direct connection to $U$ since
\begin{align}
    \Pi(s) \cap U &= \left\{ x \in \R^{d+1} \mid x_{d+1} = 2x_{[d]}^Tz - z^Tz + r^2 = x_{[d]}^Tx_{[d]} \right\}
\end{align}
where it holds that
\begin{alignat}{2}
    &&2x_{[d]}^Tz_{[d]} - z_{[d]}^Tz_{[d]} + r^2 &= x_{[d]}^Tx_{[d]}\\
    &\Leftrightarrow\quad& \dist(x_{[d]}, z) &= r^2\\
    &\Leftrightarrow\quad& x_{[d]} &\in s.
\end{alignat}
The intersection of $\Pi(s)$ and $U$ is therefore the vertical projection of $s$ onto $U$.
The following proofs that this mapping is an identification of the two concepts.
\begin{lemma}
    \label{lem:pibijection}
    $\Pi$ is a bijection from spheres in $h_0$ to hyperplanes in $\Ha$ which intersect $U$.
\end{lemma}
\begin{proof}
    $\Pi$ is clearly injective since two spheres with different centers map to hyperplanes with different normal vectors and for two concentric spheres to have the same offset, $r$ must be equal.
    $\Pi$ is also surjective if every intersection of hyperplane which is not parallel to $x_{d+1}$ with $U$ is an ellipsoid which results in a sphere if projected to $h_0$.

    Let $n \in \R^{d+1}$ be a normal vector with $n_{d+1} = 1$, let $b \in \R$ be an offset and $h = \left\{ y \in \R^{d+1} \mid n^T y = b \right\}$ a hyperplane with $h \in \Ha$.
    The projection to $h_0$ of the intersection of $h$ with $U$ is given by
    \begin{align}
        h \cap U = \left\{ x \in \R^{d+1} \mid x_{d+1} = b - n_{[d]}^T x_{[d]} = x_{[d]}^T x_{[d]} \right\}
    \end{align}
    where
    \begin{alignat}{2}
        &&b - n_{[d]}^Tx_{[d]} &= x_{[d]}^Tx_{[d]}\\
        &\Leftrightarrow\quad& x_{[d]}^Tx_{[d]} + n_{[d]}^Tx_{[d]} - b &= 0.
    \end{alignat}

    To show that this projection is actually a sphere, it should be described by a center $v \in \R^d$ and a radius $\alpha \geq 0$ in the equation
    \begin{alignat}{2}
        &&\dist(x_{[d]},v)^2 &= \alpha.
        \intertext{Now let $\alpha = b + \frac{1}{4} n_{[d]}^Tn_{[d]}$ and $v = \frac{1}{2}n_{[d]}$. Then}
        &&\dist(x_{[d]},\frac{1}{2}n_{[d]})^2 &= b + \frac{1}{4} n_{[d]}^Tn_{[d]}\\
        &\Leftrightarrow\quad&x_{[d]}^Tx_{[d]} - n_{[d]}^Tx_{[d]} + \frac{1}{4} n_{[d]}^Tn_{[d]} &= b + \frac{1}{4} n_{[d]}^Tn_{[d]}\\
        &\Leftrightarrow\quad& x_{[d]}^Tx_{[d]} + n_{[d]}^Tx_{[d]} - b &= 0
    \end{alignat}
    so the projection of the intersection is indeed a sphere if $b > -\frac{1}{4}n_{[d]}^Tn_{[d]}$, a point if $b = -\frac{1}{4}n_{[d]}^Tn_{[d]}$ and $h$ does not intersect $U$ otherwise.
\end{proof}

$\Pi(s)$ being the vertical projection of spheres to $U$ can also be used to compute the power of some point with respect to $s$.
\begin{observation}
    \label{obs:distances}
    Let $s = (z, r^2)$ be a sphere in $h_0$ and $x \in h_0$.
    Let $x^\prime$ and $x^{\prime\prime}$ denote the vertical projections of $x$ onto $U$ and $\Pi(s)$. It then holds that
    \begin{align}
        \pow(x_{[d]}, s) = \dist(x, x^\prime) - \dist(x, x^{\prime\prime})
    \end{align}
\end{observation}
\begin{proof}
    Since the projections of $x$ did not change the first $d$ coordinates, it holds that $\dist(x, x^\prime) = x_{[d]}^Tx_{[d]}$ and $\dist(x, x^{\prime\prime}) = 2x_{[d]}^Tz - z^Tz + r^2$, with their difference being $(x_{[d]} - z)^T(x_{[d]} - z) - r^2 = \pow(x_{[d]}, s)$.
\end{proof}

This directly implies the following lemma, which connects chordales to the newly formed hyperplanes by recognizing that the intersection of two hyperplanes in $\R^{d+1}$ contains projected points with the same power value for the respective spheres.

\begin{lemma}
    \label{lem:verticalprojection}
    Let $s$ and $t$ be non-cocentric spheres in $h_0$.
    Then $\chor(s, t)$ is the vertical projection of $\Pi(s) \cap \Pi(t)$ onto $h_0$.
\end{lemma}
\missingfigure{3D Figure showing the Paraboloid and Planes intersecting.}

\subsection{Duality of points and hyperplanes}
\label{sub:duality_of_points_and_hyperplanes}
The hyperplanes established with the mapping $\Pi$ will now be connected to specific \define{polar points} to establish a bijective mapping between $j$-flats defined by the intersection of these hyperplanes and $(d-j)$-flats in this dual domain.

\begin{definition}[Polarity Function]
    Let $\Ha$ be the set of all hyperplanes not parallel to the $x_{d+1}$ axis and let $\F$ be the set of all flats which do not contain any vectors parallel to the $x_{d+1}$ axis
    \begin{align}
        \F &\coloneqq \left\{ f \subseteq \R^{d+1} \mid
                \exists 1 \leq k \leq d + 1: \exists h_1, \dots, h_{k} \in \Ha : \varnothing \neq f = \bigcap_{i = 1}^{k} h_i\right\}.
        \intertext{The \define{polarity function $\Delta$} then is a mapping in $\F$ given by}
        \Delta &: \left\{ \begin{aligned}
            \F &\to \F\\
            f &\mapsto \begin{dcases}
                \left\{ \begin{pmatrix} \frac{1}{2} a \\ -a_{d+1} \end{pmatrix} \right\} &\qquad \textnormal{if } h \in \Ha \textnormal{ with } x \in h \Leftrightarrow x_{d+1} = a^Tx_{[d]} + a_{d+1}\\
                \bigcup_{\substack{h \in \Ha:\\f \subseteq h}} h &\qquad \textnormal{if } \dim(f) < d
            \end{dcases}
        \end{aligned}
        \right..
    \end{align}
\end{definition}

Let $h \in \Ha$ be a hyperplane and $p \in \R^{d+1}$. The images $\Delta(h)$ and $\Delta(p)$ are called the \define{pole} and \define{polar hyperplane} of $p$ and $h$ respectively.
The following lemma shows that $\Delta$ is involutory, i.e.~its own inverse, and that it connects flats of different dimensionalities in a dual manner.
\begin{lemma}
    \label{lem:deltainvolutory}
    $\Delta$ is an involutory function and a bijection from $j$-flats to $(d-j)$-flats in $\F$ for $0 \leq j \leq d$.
\end{lemma}
\begin{proof}
    Let $F = f + X \subset \R^{d+1} \in \F$ be some flat with $f \in \R^{d+1}$, $\dim(X) = j$ ($0 \leq j \leq d$) and
    \begin{align}
        X^\bot = \left\{ n \in \R^{d+1} \mid \forall x \in X. \scalar{n, x} = 0 \right\}
    \end{align}
    the set of all vectors orthogonal to $X$ for which $\dim(X^\bot) = d - j + 1$.
    Then all hyperplanes containing $F$ have a normal vector which is in $X^\bot$.
    Let $n \in X^\bot$ and
    \begin{align}
        h(n) &= \left\{x \in \R^{d+1} \mid \scalar{n, x - f} = 0\right\}\\
        &= \left\{ x \in \R^{d+1} \mid n_{d+1} \cdot x_{d+1} = -n_{[d]}^Tx_{[d]} + n^Tf \right\}
    \end{align}
    its corresponding hyperplane containing $F$.
    Note that by definition of $\F$, for all $n \in X^\bot$ it holds that $x_{d+1} \neq 0$.
    Then let $N = \left\{ n \in X^\bot \mid n_{d+1} = 1 \right\}$ be the set of all possible normalized normal vectors with $\dim(N) = d - j$ and
    \begin{align}
        \Delta(F) &= \Delta(h(N))\\
        &= \bigcup_{n \in N} \Delta(h(n)) \\
        &= \bigcup_{n \in N} \Delta \left( \left\{ x \in \R^{d+1} \mid x_{d+1} = -n_{[d]}^Tx_{[d]} + n^Tf \right\} \right) \\
        &= \bigcup_{n \in N} \left\{ \begin{pmatrix} -\frac{1}{2} n_{[d]}\\ - n^T f \end{pmatrix} \right\} \\
        &= \bigcup_{n \in N} \left\{ \begin{pmatrix} -\frac{1}{2} n_{[d]}\\ - n_{[d]}^T f_{[d]} - f_{d+1} \end{pmatrix} \right\}.
    \end{align}
    $\Delta(F)$ is therefore a $(d - j)$-flat which is the result of an affine transformation on $N$.

    Now assume $\Delta(F) \not\in \F$.
    Then $\Delta(F)$ is not expressible as the intersection of hyperplanes not parallel to the $x_{d+1}$-axis and therefore, there exist two different $d^{(1)}, d^{(2)} \in \Delta(F)$ with $d_{[d]}^{(1)} - d_{[d]}^{(2)} = 0$.
    Let $n^{(1)}, n^{(2)} \in N$ with $\Delta(h(n^{(1)})) = \left\{ d^{(1)} \right\}$ and $\Delta(h(n^{(2)})) = \left\{ d^{(2)} \right\}$.
    Then
    \begin{align}
        0 &= d_{[d]}^{(1)} - d_{[d]}^{(2)}\\
        &= \Delta(h(n^{(1)}))_{[d]} - \Delta(h(n^{(2)}))_{[d]}\\
        &= -\frac{1}{2} n^{(1)}_{[d]} + \frac{1}{2} n^{(2)}_{[d]}
    \end{align}
    and $n^{(1)}_{[d]} = n^{(2)}_{[d]}$.
    But since $n^{(1)}_{d+1} = n^{(2)}_{d+1} = 1$ it follows that $n^{(1)} = n^{(2)}$ and therefore $d^{(1)} = d^{(2)}$ which is a contradiction, so $\Delta(F) \in \F$.
    This proofs the well-definedness of $\Delta$.

    The last step is to show that $\Delta$ is involutory.
    \begin{alignat}{2}
        &x^\ast \in \Delta(\Delta(F)) &&= \bigcup_{\substack{h \in \Ha:\\ \Delta(F) \subseteq h}} \Delta(h)\\
        &\Leftrightarrow \exists h \in \Ha &&{}: \Delta(F) \subseteq h \wedge x^\ast \in \Delta(h)\\
        &\Leftrightarrow \forall x \in \Delta(F) &&{}: x_{d+1} = 2 \left( x_{[d]}^\ast \right)^T x_{[d]} - x_{d+1}^\ast\\
        &\Leftrightarrow \forall n \in N &&{}: -n^Tf = -2 \left( x_{[d]}^\ast \right)^T \cdot \frac{1}{2}n_{[d]} - x_{d+1}^\ast\\
        &\Leftrightarrow \forall n \in N &&{}: x^\ast \in h(n)\\
        &\Leftrightarrow x^\ast \in F,
    \end{alignat}
    so $\Delta(\Delta(F)) = F$ for any face $F \in \F$.
\end{proof}

An additional property of $\Delta$ is its preservation of relative positions of points and hyperplanes.
\todo[inline]{As a service to the reader!}
\begin{lemma}
    \label{lem:relativepositions}
    Let $p \in \R^{d+1}$ and $h$ a hyperplane in $\R^{d+1}$.
    Then $p$ is above, in or below $h$ exactly if $\Delta(h)$ is above, in or below $\Delta(p)$ respectively.
\end{lemma}
\begin{proof}
    Let $x,n \in \R^{d+1}$ and $h = \left\{ y \in \R^{d+1} \mid y_{d+1} = n_{[d]}^Ty_{[d]} + n_{d+1} \right\}$ a hyperplane in $\R^{d+1}$.
    Then by definition and \cref{lem:deltainvolutory}
    \begin{align}
        \Delta(h) &\coloneqq \begin{pmatrix} \frac{1}{2} n \\ -n_{d+1} \end{pmatrix}  \in \R^{d+1}\\
        \Delta(p) &= \left\{ y \in \R^{d+1} \mid y_{d+1} = 2x_{[d]}^Ty_{[d]} - x_{d+1} \right\}
    \end{align}
    Any point $y \in \R^{d+1}$ is above $\Delta{p}$ if
    \begin{align}
        2x_{[d]}^Ty_{[d]} - y_{d+1} - x_{d+1} > 0
    \end{align}
    and on or below the hyperplane when it is equal or smaller.
    Inserting $\Delta(h)$ into the equation yields
    \begin{align}
        2x_{[d]}^T \left( \frac{1}{2}n_{[d]} \right) + n_{d+1} - x_{d+1} = n_{[d]}^Tx_{[d]} - x_{d+1} + n_{d+1}
    \end{align}
    which is equal to the expression determining the relative position of $x$ to $h$.
\end{proof}

\subsection{Power Diagrams and Polyhedra}
\label{sub:power_diagrams_and_polyhedra}
Having established the bijectivity of $\Pi$ it can be shown that power diagrams in $\R^d$ can be identified with boundaries of $(d+1)$-polyhedra.
Since $\Pi$ provides a mapping to hyperplanes which intersect $U$, only polyhedra which are bounded by such hyperplanes can be considered.
Any other polyhedron can however be converted to such a polyhedron by moving it up in $x_{d+1}$-direction, conserving their combinatorical structure.
\begin{theorem}
    \label{thm:equivalentpolyhedron}
    For any $(d+1)$-polyhedron P which is expressible as the intersection of halfspaces pointing upwards, there exists an affinely equivalent power diagram in $h_0$ and vice versa.
\end{theorem}
\begin{proof}
    Let $P = \bigcap_{i=1}^n h_i^+$ of hyperplanes $h_i$ with normal vectors with positive $(d+1)$st coordinates such that for facet $f_i$ of $P$ it holds that $f_i \subseteq h_i$.
    Also assume that $h_i \cup U \neq h_i$ for all $i$ which can be achieved by moving the polyhedron in $x_{d+1}$-direction.

    \Cref{lem:pibijection} implies that there is a set $S = \left\{ s_1, \dots, s_n \right\}$ of spheres in $h_0$ such that $\Pi(s_i) = h_i$.
    Using \cref{obs:distances} it holds that the vertical projection of any $x \in h_0$ onto $P$ is in $f_i$ (and therefore $h_i$) exactly if $x \in \cell(s_i)$ is in $\PD(S)$.
    This means that $\cell(s_i)$ is exactly the vertical projection of $f_i$ onto $h_0$ for all $1 \leq i \leq n$, giving that $\PD(S)$ is affinely equivalent to $P$.

    Conversely, given any set of spheres $S$ in $h_0$ a corresponding polyhedron can be constructed by intersecting the upper halfspaces of the hyperplanes in $\Pi(S)$.
\end{proof}
To also describe polyhedra $P$ generated using the intersection of upper halfspaces, one can inspect the reflection of $P$ through $h_0$ as described in \cite{aurenhammer1987power}.

Having established the existence of an affinely equivalent polyhedron for each set of spheres in $h_0$, the following theorem will show that using the polarity function $\Gamma$, it is possible to relate power diagrams to convex hulls.
Remember that a convex hull splits into its top and bottom part given by the sign of the $(d+1)$st component of the normal vector, where vertical facets are assigned to neither parts.
\begin{theorem}
    \label{thm:equivalentconvexhull}
    For any finite set $M \subset \R^{d+1}$ there exists a set $S$ of spheres in $h_0$ such that $\PD(S)$ is dual to $\CHb(M)$ up to movement in $x_{d+1}$-direction.
\end{theorem}
\begin{proof}
    By \cref{thm:equivalentpolyhedron} there exists an affinely equivalent polyhedron $P$ for each $\PD(S)$ in $h_0$ which is defined by the intersection of the upper halfspaces of the hyperplanes $H = \left\{ h_1, \dots, h_n \mid h_i = \Pi(s_i) \right\}$ and vice versa, up to movement in $x_{d+1}$-direction.
    Let $M = \Delta(H)$ the set of all polars of the hyperplanes corresponding to all spheres, then $\CHb(M)$ will be dual to $P$.

    Let $f_i$ be the facet associated with $h_i$ (see the proof of \cref{thm:equivalentpolyhedron}) and let $p_i = \Delta(h_i)$.
    Let also $f_i$ and $f_j$ be adjacent in a $(d-1)$-face $g$ ($1 \leq i < j \leq n$).
    Then every $x \in g$ is in $h_i \cap h_j$ and above each $h \in H \setminus \left\{ h_i, h_j \right\}$ via \cref{obs:distances}.

    \Cref{lem:relativepositions} now implies that exactly then $p_i, p_j \in \Delta(x)$ and every other point $p \in M \setminus \left\{ p_i, p_j \right\}$ is above $\Delta(x)$.
    The line defined by $p_i$ and $p_j$, which is $\Delta(g)$, therefore defines an edge of $\CHb(M)$.
    Since a similar argument holds for all other $j$-faces, $P$ is dual to $\CHb(M)$ and therefore, $\PD(S)$ is, too.
\end{proof}

\section{Constructing Power Diagrams}
\label{sec:constructing_power_diagrams}
The theoretical results of the previous sections will now be applied to the formulation of algorithms to construct the power diagram $\PD(S)$ of some set of spheres $S$ in $d$ dimensions.
\Cref{obs:cellsarepolyhedra} implies that the cells of those power diagrams are polyhedra which share faces at their boundaries.

To represent those boundaries (and therefore the power diagrams), a data structure called incidence lattices will be introduced.
Also based on \cref{obs:cellsarepolyhedra}, a naive algorithm to find $0$-faces can be formulated, which is based on the observation that every such faces is defined by at least $(d+1)$ spheres.
Lastly, an efficient algorithm based on the results of \cref{sec:embedding_in_d_1_dimensions} and the known problem of constructing convex hulls will be presented and its running time analyzed.

\subsection{Incidence Lattices}
\label{sub:incidence_lattices}
\Cref{thm:equivalentpolyhedron} establishes that for every power diagram in $d$ dimensions there is a $(d+1)$-polyhedron which is affinely equivalent.
This means that all chordales which exist in the power diagram and their intersections which form flats of lower dimensionality are represented as faces in this polyhedron as can be seen from \cref{lem:verticalprojection}.
To represent all faces which are boundaries of cells in the power diagram, one can therefore choose a data structure which represents the faces of the equivalent polyhedron.

Grünbaum~\cite{grunbaum2003convex} observes that by creating a partial order on faces of a polytope induced by set inclusion of the points in the faces, one can obtain the so called incidence lattice of the polyhedron.
It is also described in more detail in \cite{edelsbrunner1986constructing} for the two-dimensional case.
After the following definition, an important result about the size of these lattices will be presented.

\begin{definition}[Incidence Lattice]
    Let $P$ be a polyhedron whose set of non-empty faces is denoted by $F$.
    The \define{incidence lattice} of $P$ is a directed graph
    \begin{align}
        \IL(P) &\coloneqq (F, E)
    \end{align}
    with the set of edges $E$ given by
    \begin{align}
        E &\coloneqq \left\{ (f_1, f_2) \in F^2 \middle| f_1 \subsetneq f_2 \wedge \nexists f_3 \in F : f_1 \subsetneq f_3 \subsetneq f_2 \right\} \subseteq F^2.
    \end{align}
\end{definition}

The minimal vertices of an incidence lattices are the faces of lowest dimension in the polyhedron, while the single maximal node is the polyhedron itself.

\Cref{lem:deltainvolutory} implies that a dual polyhedron obtained using the polarity function $\Delta$ has a very similar combinatorical structure compared to the original polyhedron.
Since every $j$-face has been replaced by a $(d-j)$-face, the subset-relationship between two faces are reversed, i.e.~if $f_1 \subsetneq f_2$, then $\Delta(f_1) \supsetneq \Delta(f_2)$.
This directly yields that the incidence lattice of this dual polyhedron is isomorphic to the graph created by reverting all edges in the original incidence lattice.
Together with \cref{thm:equivalentpolyhedron} it follows that the incidence lattice describing the boundaries of a power diagram can be obtained from an incidence lattice of the lower part of a convex hull by reverting all edges in the lattice.

\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[font=\scriptsize]
        \tikzstyle{corner} = [circle, fill, tumblue, minimum size=8pt, inner sep=0]
        \tikzstyle{lattice} = [circle, fill, tumblue, minimum size=6pt, inner sep=0]
        \tikzstyle{lattice edge} = [thick, arrows={-latex}, shorten >=4pt]

        \coordinate (p1) at (-1, 0);
        \coordinate (p2) at (1, 0);
        \coordinate (p3) at (1, 2);
        \coordinate (p4) at (-1, 2);

        \draw[fill=tumgreen!40]
        (p1) -- (p2) -- (p3) -- (p4) -- (p1);

        \draw[black, very thick]
        (p1) -- (p2) -- (p3) -- (p4) -- (p1);

        \draw
        (p1) node[corner, label={below:$v_1$}] {}
        (p2) node[corner, label={below:$v_2$}] {}
        (p3) node[corner, label={above:$v_3$}] {}
        (p4) node[corner, label={above:$v_4$}] {};

        \coordinate (d1) at (3.5, -0.5);
        \coordinate (d2) at (5, -0.5);
        \coordinate (d3) at (6.5, -0.5);
        \coordinate (d4) at (8, -0.5);
        \coordinate (d12) at (3.5, 1);
        \coordinate (d23) at (5, 1);
        \coordinate (d34) at (6.5, 1);
        \coordinate (d14) at (8, 1);
        \coordinate (d1234) at (5.75, 2.5);

        \draw[lattice edge] (d1) to (d12);
        \draw[lattice edge] (d1) to[bend right=15] (d14);
        \draw[lattice edge] (d2) to (d12);
        \draw[lattice edge] (d2) to (d23);
        \draw[lattice edge] (d3) to (d23);
        \draw[lattice edge] (d3) to (d34);
        \draw[lattice edge] (d4) to (d14);
        \draw[lattice edge] (d4) to (d34);
        \draw[lattice edge] (d12) to (d1234);
        \draw[lattice edge] (d23) to (d1234);
        \draw[lattice edge] (d34) to (d1234);
        \draw[lattice edge] (d14) to (d1234);

        \draw
        (d1) node[lattice, label={below:$1$}] {}
        (d2) node[lattice, label={below:$2$}] {}
        (d3) node[lattice, label={below:$3$}] {}
        (d4) node[lattice, label={below:$4$}] {}
        (d12) node[lattice, black, label={left:$\left\{ 1, 2 \right\}$}] {}
        (d23) node[lattice, black, label={left:$\left\{ 2, 3 \right\}$}] {}
        (d34) node[lattice, black, label={right:$\left\{ 3, 4 \right\}$}] {}
        (d14) node[lattice, black, label={right:$\left\{ 1, 4 \right\}$}] {}
        (d1234) node[lattice, tumgreen, rectangle, label={above:$\left\{ 1, 2, 3, 4 \right\}$}] {};

        \coordinate (s1) at (11, 0);
        \coordinate (s2) at (13, 0);
        \coordinate (s3) at (13, 2);
        \coordinate (s4) at (11, 2);
        \coordinate (v1) at (12, 1);

        \draw[black, very thick]
        (v1) -- ($(v1) + (1.5, 0)$)
        (v1) -- ($(v1) + (-1.5, 0)$)
        (v1) -- ($(v1) + (0, 1.5)$)
        (v1) -- ($(v1) + (0, -1.5)$);

        \draw
        (s1) node[corner, label={below:$s_1$}] {}
        (s2) node[corner, label={below:$s_2$}] {}
        (s3) node[corner, label={above:$s_3$}] {}
        (s4) node[corner, label={above:$s_4$}] {}
        (v1) node[corner, tumgreen, rectangle] {};
    \end{tikzpicture}
    \caption{The polytope on the left is given as the convex hull of $\left\{ v_1, \dots, v_4 \right\}$.
    The minimal nodes of the incidence lattice are the four vertices, while the maximal node is the complete polytope. The $1$-faces (edges) form the middle layer of the lattice.
    The dual power diagram is a Voronoi diagram which can be seen on the right side which has an incidence structure described by the same lattice with reversed edges.}
    \label{fig:incidencelattice}
\end{figure}
\Cref{fig:incidencelattice} shows an example of this relationship.
A square defined by four vertices can be interpreted as a degenerated lower convex hull in three dimensions. It is then dual to a Voronoi diagram in two dimensions whose incidence structure is described by the same incidence lattice with reverted edges.

Since every non-empty face at the boundary between two cells is represented by a node in the incidence lattice, the following result by Bronsted \cite{brondsted2012introduction} bounds the size of incidence lattices describing a power diagram (and therefore the size of incidence lattices of polyhedra which are expressable as intersections of upwards pointing halfspaces).

\begin{lemma}
    \label{lem:latticesexponential}
    Let $S$ be a set of $n$ spheres in $\R^d$ with $n > d > 0$ and let $f_j$ denote the maximal number of $j$-faces of a $(d + 1)$ polyhedron with $n$ facets. Then $f_j \in \Oh(n^{\left\lceil d/2 \right\rceil})$ and $\PD(S)$ contains at most $n$ cells, $f_j$ $j$-faces for $1 \leq j \leq d-1$ and $f_0 - 1$ vertices.
\end{lemma}

A direct consequence of this lemma is that any algorithm constructing the complete incidence lattice of some power diagram will have a running time in $\Omega(n^{\left\lceil d/2 \right\rceil})$ for $n$ spheres in $d$ dimensions.
To lessen the impact of higher dimensions somewhat, the implementation presented here will only create shallow incidence lattices which only contain $0$-faces (vertices), $1$-faces (edges) and $d$-faces (cells) of a power diagram.

\subsection{Naive Algorithm}
\label{sub:naive_algorithm}
For any power diagram which contains a cell bounded by a $0$-face, every cell is bounded by a $0$-face, as stated by \cref{lem:zerofaces}.
The proof of the lemma yields that the existance of a $0$-face in a power diagram is guaranteed if there are at least $d+1$ linearly independent spheres, which also is a necessary condition.

Faces are called internal faces of a power diagram if they can be expressed as the convex hull of $0$-faces, i.e.~if they are polytopal.
The naive algorithm presented here uses the observations of the lemma to find those $0$-faces.
Starting from the set of all existing $0$-faces together with the spheres which define them, it is possible to reconstruct all internal faces inductively.

Since all $0$-faces must be defined by at least $d+1$ spheres, the naive algorithm iterates over all groups of $d+1$ spheres and checks whether they define a $0$-face.
\begin{algorithm}[$0$-faces of Power Diagrams]
    \label{alg:zerofaces}
    Let $S = \left\{ s_1, \dots, s_n \right\}$ a set of spheres in $d$ dimensions with $n > d$ and at least $d+1$ spheres linearly independent.

    \begin{enumerate}[label=Step \arabic*.,ref=Step \arabic*,leftmargin=5em]
        \item \label{alg:0f:step1} Create an empty incidence lattice $\IL$.
        \item \label{alg:0f:step2} Find the set of all possible groups $\Ge = \binom{S}{d + 1}$.
        \item \label{alg:0f:step3} For every $G \in \Ge$, check if it is a $0$-face.
            \begin{enumerate}[label*=\arabic*.,ref=\theenumi.\arabic*]
                \item \label{alg:0f:step31} Try to find the point $p \in \R^d$ of intersection of all chordals of pairs of spheres in $G$.
                \item \label{alg:0f:step32} If $p$ exists, ensure that for all $o \in S \setminus G$ it holds that $\pow(p, o) > \pow(p, g)$ for any $g \in G$.
                \item \label{alg:0f:step33} If $p$ is a $0$-face, add $p$ and all $g \in G$ to the incidence lattice $\IL$, add edges $(g, p)$ to $\IL$ for all $g \in G$.
            \end{enumerate}
        \item \label{alg:0f:step4} Merge $0$-faces $p_1, p_2 \in \R^{d}$ defined by $G_1, G_2 \in \Ge$ if $p_1 = p_2$. Remove $p_2$ from $\IL$ and add edges $(g, p_1)$ to $\IL$ for all $g \in G_2$.
    \end{enumerate}
\end{algorithm}
To analyze the running time, the different steps are analyzed seperately and lead to a bound derived from the combinatorical structure of $\Ge$.
\begin{theorem}
    Let $S = \left\{ s_1, \dots, s_n \right\}$ a set of spheres in $d$ dimensions with $n > d$ and at least $d + 1$ spheres linearly independent.
    \cref{alg:zerofaces} then finds the $0$-faces of $\PD(S)$ in $\Oh(\binom{n}{d + 1} \cdot \max(d^3, n))$ time.
\end{theorem}
\begin{proof}
    \ref{alg:0f:step1} is in $\Oh(1)$, \ref{alg:0f:step2} is in $\Oh(\abs{\Ge} \cdot d)$ and \ref{alg:0f:step4} can be achieved in $\Oh(\abs{\Ge} \cdot d)$, where the factor comes from adding the edges from $G_2$ to the incidence lattice, assuming that adding an edge to the lattice can be done in $\Oh(1)$.
    Finding the point $p$ in \ref{alg:0f:step31} amounts to solving a system of linear equations with a matrix of size $(d+1) \times d$, which takes $\Oh(d^3)$ time.
    \ref{alg:0f:step32} needs to check every sphere in $S$ which is not in $G$ and therefore can be bounded by $\Oh(n)$, while \ref{alg:0f:step33} only operates on the spheres in $G$ and therefore only takes $\Oh(d)$ time.
    The running time of this algorithm is therefore clearly dominated by \ref{alg:0f:step3} since \ref{alg:0f:step31} and \ref{alg:0f:step32} both have to be performed $\abs{\Ge} = \binom{\abs{S}}{d + 1} = \binom{n}{d + 1}$ times.
    This leads to the desired bound.
\end{proof}

If one assumes $d \ll n$, this running time can be approximated as $\Oh(n^{d+2})$.
To construct the complete incidence lattice of the power diagram, this shallow representation has to be filled by adding the internal $j$-faces for $1 \leq j \leq d -1$ and extremal faces would need to be found.
Since this naive algorithm is not applicable in practice due to its running time, these questions were not explored further and it was only used as a test implementation for the efficient algorithm presented in the next subsection.

\subsection{Dual Algorithm}
\label{sub:dual_algorithm}
According to \cref{thm:equivalentconvexhull}, an incidence lattice which is equivalent to the power diagram $\PD(S)$ of some set of spheres $S$ in $d$ dimensions can be obtained using the lower part of a certain convex hull in $\R^{d+1}$.
\cite{seidel1981convex} describs an optimal algorithm to obtain convex hulls in even dimensions, while \cite{preparata1977convex} describes one which is optimal for $d \in \left\{ 2, 3 \right\}$.
The implementation to this paper uses the quickhull algorithm described in \cite{barber1996quickhull}.
Their results can be summarized as follows.
\begin{lemma}
    \label{lem:convexhulls}
    Let $M$ be a set of $n$ points in $\R^d$.
    The convex hull of $M$ can be determined in $\Oh(n \log n)$ time for $d = 3$ and in $\Oh(n \log n + n^{\left\lceil d/2\right\rceil})$ time for $d > 3$.
    These bounds are optimal for $d = 3$ or $d$ even.
\end{lemma}

To construct a power diagram, it is now enough to follow the path of \cref{sec:embedding_in_d_1_dimensions} to transform it to $d+1$ dimensions, calculate the convex hull $\CHb$ of the polar points and project the results back to the original space.
More formally, this can be described as follows.

\begin{algorithm}[Power Diagram using Embedding in $d+1$ Dimensions]
    \label{alg:embedding}
    Let $S = \left\{ s_1, \dots, s_n \right\}$ a set of spheres in $d$ dimensions.
    The computation of $\PD(S)$ requires three steps.
    \begin{enumerate}[label=Step \arabic*.,ref=Step \arabic*,leftmargin=5em]
        \item \label{alg:pd:step1} Compute the hyperplanes $\Pi(s_i)$ and their poles $p_i = \Delta(\Pi(s_i))$ for every sphere $1 \leq i \leq n$.
        \item \label{alg:pd:step2} Determine the incidence structure $\IL_b$ of the polyhedron defined by the hyperplanes $\Pi(s_1), \dots, \Pi(s_n)$.
            \begin{enumerate}[label*=\arabic*.,ref=\theenumi.\arabic*]
                \item \label{alg:pd:step21} Construct the convex hull of $\left\{ p_1, \dots, p_n \right\}$ such that it is represented by the incidence lattice $\IL$.
                \item \label{alg:pd:step22} Split $\IL$ into the top and bottom parts according to the slope of the hyperplanes containing the facets, obtaining $\IL_b$ representing $\CHb(\left\{ p_1, \dots, p_n \right\})$.
                \item \label{alg:pd:step23} Replace each $j$-face in $\IL_b$ by a $(d - j)$-face for $0 \leq j \leq d$. For each vertex arising from a facet $f$, store the polar point $\Delta(h)$ of the hyperplane $h$ containing $f$.
            \end{enumerate}
        \item \label{alg:pd:step3} Project $\IL_b$ vertically onto $h_0$ by forgetting the $(d+1)$st coordinates of the vertices. This yields $\PD(S)$ in $h_0$.
    \end{enumerate}
\end{algorithm}

The different steps of the algorithm allow for a straightforward analysis of its running time.
\begin{theorem}
    Let $S$ be a set of $n$ spheres in $\R^d$ and denote the amount of time necessary to compute the convex hull of $n$ points in $\R^{d}$ as $\Time_d(n)$.
    \Cref{alg:embedding} then constructs $\PD(S)$ in $\Oh(\Time_{d+1}(n))$ time.
\end{theorem}
\begin{proof}
\ref{alg:pd:step1} and \ref{alg:pd:step3} can be performed in $\Oh(n)$ time.
Let $\IL_b$ be the incidence lattice constructed by \ref{alg:pd:step21}.
Then \ref{alg:pd:step22} and \ref{alg:pd:step23} are bounded by $\Oh(\abs{\IL_b})$, while depending on the implementation, \ref{alg:pd:step23} can be performed in $\Oh(1)$ time.
Since \ref{alg:pd:step21} must take at least $\Omega(\abs{\IL_b})$ time, the construction of the convex hull of the polar points dominates the running time of the algorithm.
\end{proof}

Since \cref{lem:convexhulls} ensures the optimality of the convex hull algorithms and every other operation in \cref{alg:embedding} is dominated by them, this is an optimal algorithm to construct power diagrams in $d$ dimensions for $d = 2$ or $d$ odd.

\section{Implementation}
\label{sec:implementation}
\subsection{Incidence Lattice}
\label{sub:incidence_lattice}
\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[font=\scriptsize]
        \tikzstyle{corner} = [circle, fill, tumblue, minimum size=8pt, inner sep=0]
        \tikzstyle{lattice} = [circle, fill, tumblue, minimum size=6pt, inner sep=0]
        \tikzstyle{lattice edge} = [thick, arrows={-latex}, shorten >=4pt]
        \tikzstyle{noend} = [dotted, arrows={-}, shorten >=8em]
        \tikzstyle{marked} = [tumred, densely dashed, very thick, rectangle]

        \node at (0, 0) {
            \begin{tikzpicture}
                \coordinate (d1) at (0, 0);
                \coordinate (d2) at (1.5, 0);
                \coordinate (d3) at (3, 0);
                \coordinate (d4) at (4.5, 0);
                \coordinate (d5) at (6, 0);
                \coordinate (d12) at (0.75, 1.5);
                \coordinate (d23) at (2.25, 1.5);
                \coordinate (d34) at (3.75, 1.5);
                \coordinate (d45) at (5.25, 1.5);
                \coordinate (d123) at (1.5, 3);
                \coordinate (d234) at (3, 3);
                \coordinate (d1234) at (1.5, 4.5);
                \coordinate (d2345) at (4.5, 4.5);

                \draw[lattice edge] (d1) to (d12);
                \draw[lattice edge] (d2) to (d12);
                \draw[lattice edge] (d4) to (d1234);
                \draw[lattice edge, noend] (d2) to (d2345);
                \draw[lattice edge, noend] (d3) to (d2345);
                \draw[lattice edge, noend] (d4) to (d2345);
                \draw[lattice edge, marked] (d12) to (d1234);
                \draw[lattice edge, marked] (d3) to (d1234);

                \draw
                (d1) node[lattice, label={below:$1$}] {}
                (d2) node[lattice, label={below:$2$}] {}
                (d3) node[lattice, label={below:$3$}] {}
                (d4) node[lattice, label={below:$4$}] {}
                (d12) node[lattice, label={left:$\left\{ 1, 2 \right\}$}] {}
                (d1234) node[lattice, label={above:$\left\{ 1, 2, 3, 4 \right\}$}] {}
            \end{tikzpicture}
        };

        \node at (7, 0) {
            \begin{tikzpicture}
                \coordinate (d1) at (0, 0);
                \coordinate (d2) at (1.5, 0);
                \coordinate (d3) at (3, 0);
                \coordinate (d4) at (4.5, 0);
                \coordinate (d5) at (6, 0);
                \coordinate (d12) at (0.75, 1.5);
                \coordinate (d23) at (2.25, 1.5);
                \coordinate (d34) at (3.75, 1.5);
                \coordinate (d45) at (5.25, 1.5);
                \coordinate (d123) at (1.5, 3);
                \coordinate (d234) at (3, 3);
                \coordinate (d1234) at (1.5, 4.5);
                \coordinate (d2345) at (4.5, 4.5);

                \draw[lattice edge] (d1) to (d12);
                \draw[lattice edge] (d2) to (d12);
                \draw[lattice edge] (d4) to (d1234);
                \draw[lattice edge, noend] (d2) to (d2345);
                \draw[lattice edge, noend] (d3) to (d2345);
                \draw[lattice edge, noend] (d4) to (d2345);
                \draw[lattice edge, marked] (d12) to (d123);
                \draw[lattice edge, marked] (d123) to (d1234);
                \draw[lattice edge, marked] (d3) to (d123);

                \draw
                (d1) node[lattice, label={below:$1$}] {}
                (d2) node[lattice, label={below:$2$}] {}
                (d3) node[lattice, label={below:$3$}] {}
                (d4) node[lattice, label={below:$4$}] {}
                (d12) node[lattice, label={left:$\left\{ 1, 2 \right\}$}] {}
                (d123) node[lattice, marked, label={left:$\left\{ 1, 2, 3 \right\}$}] {}
                (d1234) node[lattice, label={above:$\left\{ 1, 2, 3, 4 \right\}$}] {};
            \end{tikzpicture}
        }
    \end{tikzpicture}
    \caption{The left figure shows part of an incidence lattice in the process of being filled before the insertion of the new face $\left\{ 1,2,3 \right\}$. To identifiy the red dashed edges which need to be bisected by the new face, lower and upper boundaries have to be found.
        The face $\left\{ 1, 2 \right\}$ is a largest subset of the new face and therefore all outgoing edges have to be replaced.
        The face $\left\{ 1, 2, 3, 4 \right\}$ is a (smallest) superset of the new face and therefore, the new face has to point to it.
    }
    \label{fig:incidencelattice}
\end{figure}

\subsection{Dual Algorithm}
\label{sub:dual_algorithm}

\appendix
\section{Building the Code}
\label{sec:building_the_code}
\todo[inline]{Libraries}
\todo[inline]{Make, CMake}
\todo[inline]{Windows...}

\section{Running the Code}
\label{sec:running_the_code}
\todo[inline]{Makefile \enquote{driver}}
\todo[inline]{Some examples}

\nocite{*}
\bibliographystyle{alpha}
\bibliography{powerdiagrams}
\end{document}
