\input{preamble.tex}
\input{tikzpictures.tex}

\title{Incidence Structures of Power Diagrams}
\subtitle{Interdisciplinary Project}
\author{%
    \texorpdfstring{Markus Kaiser\\\href{mailto:markus.kaiser@in.tum.de}{markus.kaiser@in.tum.de}}{Markus Kaiser}}
\publishers{Technische Universität München}

\begin{document}
\maketitle
\begin{abstract}
    \blindtext
\end{abstract}

\section{Power Diagrams}
\label{sec:powerdiagrams}

Power diagrams in $d$-dimensional Euclidean space $\R^d$ can be understood as a particular generalization of the more well known Voronoi diagrams.
A \define{Voronoi diagram} is a partition of the space introduced by a finite set of points $M \subset \R^d$ and a metric $\dist(\cdot, \cdot)$.
It assigns every point $p \in M$ its \define{region} of points for which $p$ is closer than all other points in $M$.
Using the euclidean metric, these regions are guaranteed to be convex.
The normal vectors of the hyperplanes at the boundaries are given by the connecting line of neighbouring points with the hyperplane bisecting this line.
\begin{figure}[Htb]
    \centering
    \begin{tikzpicture}
        \path[clip, use as bounding box] (-3, 0) rectangle (7, 4);

        \node[sphere center, label={$4$}] (s0) at (     5.0,     3.0) {};
        \node[sphere center, label={above right:$6$}] (s1) at (     5.5,     1.0) {};
        \node[sphere center, label={$1$}] (s2) at (    -1.0,     2.0) {};
        \node[sphere center, label={$2$}] (s3) at (     1.0,     1.0) {};
        \node[sphere center, label={$3$}] (s4) at (     1.0,     3.0) {};
        \node[sphere center, label={$5$}] (s5) at (     3.0,     1.0) {};

        \coordinate (p0) at (    0.25,     2.0);
        \coordinate (p1) at (    4.25,    1.75);
        \coordinate (p2) at (     3.0,     3.0);
        \coordinate (p3) at (     2.0,     2.0);

        \draw[thin]
            (s5) edge (s0)
            (s5) edge (s1)
            (s0) edge (s1);
        \draw[right angle length=1.5ex, right angle symbol={s5}{s0}{p1}];
        \draw[right angle length=1.5ex, right angle symbol={s5}{s1}{p1}];
        \draw[right angle length=1.5ex, right angle symbol={s1}{s0}{p1}];

        \draw[extremal edge] (p0) edge node[extremal spheres] {${1, 2}$} ($(p0) + 10*( -0.4472, -0.8944)$);
        \draw[extremal edge] (p0) edge node[extremal spheres] {${1, 3}$} ($(p0) + 10*( -0.4472,  0.8944)$);
        \draw[internal edge] (p0) edge node[internal spheres] {${2, 3}$} (p3);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${4, 6}$} ($(p1) + 10*(  0.9701,  0.2425)$);
        \draw[extremal edge] (p1) edge node[extremal spheres] {${5, 6}$} ($(p1) + 10*(    -0.0,    -1.0)$);
        \draw[internal edge] (p1) edge node[internal spheres] {${4, 5}$} (p2);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.05] {${3, 4}$} ($(p2) + 10*(     0.0,     1.0)$);
        \draw[internal edge] (p2) edge node[internal spheres] {${3, 5}$} (p3);
        \draw[extremal edge] (p3) edge node[extremal spheres] {${2, 5}$} ($(p3) + 10*(     0.0,    -1.0)$);

        \node[point] () at (p0) {};
        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
        \node[point] () at (p3) {};
    \end{tikzpicture}
    \caption{2D-Voronoi diagrams partition the plane into regions of points with a common closest input point. The edges separating two regions can be calculated as the perpendicular bisector of the line connecting their centers. Two regions are neighbours if there exists an edge between their points in the Delaunay triangulation of the same set.}
    \label{fig:voronoi}
\end{figure}

\cref{fig:voronoi} shows an example of a Voronoi diagram in $d = 2$ dimensions.
While obtaining the hyperplanes which potentially separate the regions is easy, it must identified which of them actually exist, since not every region is a neighbour of every other region.
It can be shown \cite{aurenhammer1991voronoi} that there exists a dual relationship between Voronoi diagrams in two dimensions and Delaunay triangulations.
A \define{Delaunay triangulation} of a set of points $M$ is a graph in which three points are connected exactly if the smallest circle containing all three points does not contain any other point in $M$.
Two regions in the Voronoi diagram then are neighbours exactly if there exists an edge in the Delaunay triangulation between their corresponding points.

This gives rise to efficient algorithms for constructing the diagrams, since the triangulations can be obtained in $\Oh(n \log n)$ time by incrementally inserting points in an existing triangulation.
This algorithm was first described by Green and Sibson \cite{green1978computing} and is optimal, since one can reduce the sorting problem to finding triangulations \cite{aurenhammer1991voronoi}.
Another algorithm to find Delauny triangulation described by Aurenhammer involves lifting the two dimensional input into three dimensions by projecting it to a paraboloid.
The triangulation can then be found by computing the lower convex hull of those points, also yielding $\Oh(n \log n)$ complexity in two dimensions.

This paper will introduce a generalization of Voronoi diagrams called power diagrams.
After introducing the necessary notation, a dual relationship between these power diagrams in $d$ dimensions and polyhedra in $d+1$ dimensions will be proven.
This allows the adaptation of the aforementioned algorithm and shows its correctness in arbitrary dimensions $d \geq 1$.
Lastly, a concrete implementation of this algorithm and the needed data structures is described.

\subsection{Definition of Power Diagrams}
\label{sub:definition_of_power_diagrams}
There are multiple possible modifications of Voronoi diagrams, a few of which are decribed in \cite{aurenhammer1987power}.
To obtain \define{power diagrams}, each point $p \in M$ is assigned a \define{weight} $w(p)$, where a larger weight results in a larger cell.
The distance function of a point $x \in \R^d$ and one weighted point $p$ is then given by $\dist(x, p)^2 - w(p)$.
While other possible combinations of distance and weight have also been investigated \cite{aurenhammer1987power}, this definition has a connection to the power of circles around the points $p \in M$.

\begin{definition}[Power of a Point]
    \label{def:power}
    The \define{power} of a point $x \in \R^d$ with respect to a sphere $s = (p, r^2)$ with center $p \in \R^d$ and radius $r \in \R$ is given by
    \begin{align}
        \pow(x, s) = \dist(x, p)^2 - r^2.
    \end{align}
\end{definition}
\begin{figure}[tb]
    \centering
    \begin{subfigure}[b]{.35\linewidth}
        \begin{tikzpicture}[x=1cm, y=1cm]
            \coordinate (center) at (0, 0);
            \coordinate (point) at (2, 3);

            \node[power circle, minimum size=3cm, label={[yshift=0.5cm]below:$s$}] (circle) at (center) {};

            \coordinate (tangent) at (tangent cs:node=circle,point={(point)},solution=1);

            \draw[right angle length=1.5ex, right angle symbol={center}{tangent}{point}];

            \draw
                (tangent) edge[black] node[midway, left] {$r$} (center.center)
                (center.center) edge[black] node[pos=0.6, sloped, below] {$\dist(x, p)$} (point)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s)$} (tangent);
            \draw
                (center)
                node[power center, label={below:$p$}] () {}

                (point)
                node[power point, label={above:$x$}] () {};
        \end{tikzpicture}
        \caption{Interpretation of $\pow$}
        \label{sfig:pow_interpretation}
    \end{subfigure}
    \begin{subfigure}[b]{.55\linewidth}
        \begin{tikzpicture}[x=1cm, y=1cm]
            \coordinate (center-a) at (-2, 0);
            \coordinate (center-b) at (2, 0);
            \coordinate (point) at (0.46875, 3);

            \node[power circle, minimum size=4cm] (circle-a) at (center-a) {};
            \node[power circle, minimum size=1cm] (circle-b) at (center-b) {};

            \coordinate (tangent-a) at (tangent cs:node=circle-a,point={(point)},solution=1);
            \coordinate (tangent-b) at (tangent cs:node=circle-b,point={(point)},solution=2);

            \draw[right angle length=1.5ex, right angle symbol={center-a}{center-b}{point}];

            \draw
                (center-a.center) edge (center-b.center)
                (point) +(0, 1) edge[very thick, tumgreen] (point |- 0, -2cm)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s_1)$} (tangent-a)
                (point) edge[very thick, tumblue] node[midway, sloped, above] {$\pow(x, s_2)$} (tangent-b);

            \draw
                (center-a)
                node[power center, label={below:$p_1$}] () {}
                (center-b)
                node[power center, label={below:$p_2$}] () {}

                (point)
                node[power point, label={above right:$x$}] () {};
        \end{tikzpicture}
        \caption{Equality of powers of two spheres}
        \label{sfig:chordal}
    \end{subfigure}
    \caption{\Cref{def:power} has a nice geometric interpretation for points $x$ lying outside of the sphere $s=(p, r)$. The power $\pow(x, s) = \dist(x, p)^2 - r^2$ can be interpreted as the length of a tangent of point $p$ to the sphere $s$. When comparing the powers of two non-intersecting spheres $s_1, s_2$, the set of points $x$ for which $\pow(x, s_1) = \pow(x, s_2)$ is a hyperplane perpendicular to the line connecting the two centers but not necessarily its bisector.}
    \label{fig:power}
\end{figure}

The power function was for example mentioned at the beginning of the 19th century by Steiner \cite{steiner1881jacob} or Laguerre \cite{blaschke2013vorlesungen} as a measure of the relationship of a point to a circle.
A point has a negative power if inside, a positive power if outside and its power vanishes if it lies on the circle.
Using the Pythagorean theorem, this function has a geometric interpretation shown in \cref{fig:power}.

Using this definition, a pair $s = (p, w(p))$ of a point and its weight is called a \define{site} of the power diagram, which can be interpreted as a sphere with a radius of $\sqrt{w(p)}$.
Every such site gets assigned its partition of the space where there is no other site with lower power.
\begin{figure}[tb]
    \centering
    \begin{tikzpicture}
        \path[clip, use as bounding box] (-6, -2.05) rectangle (7, 4.05);

        \node[sphere center, label={above:$s_1$}] (s1) at (     2.0,     3.0) {};
        \draw[sphere radius] (s1) circle[radius=1.0];
        \node[sphere center, label={above:$s_5$}] (s2) at (     5.0,     0.0) {};
        \draw[sphere radius] (s2) circle[radius=1.0];
        \node[sphere center, label={above:$s_3$}] (s3) at (    -2.0,     0.0) {};
        \draw[sphere radius] (s3) circle[radius=3.0];
        \node[sphere center, label={above:$s_4$}] (s4) at (     2.0,     0.0) {};
        \draw[sphere radius] (s4) circle[radius=2.0];
        \node[sphere center, label={above:$s_2$}] (s5) at (     4.0,     2.0) {};
        \draw[sphere radius] (s5) circle[radius=1.0];

        \coordinate (p1) at (   0.625,     2.0);
        \coordinate (p2) at (     4.0,    0.75);
        \coordinate (p3) at (    2.75,     2.0);

        \draw[thin] (s4) edge (s2);
        \draw[right angle length=1.5ex, right angle symbol={s4}{s2}{p2}];
        % \draw[thin]
        %     (s4) edge (s5)
        %     (s4) edge (s2)
        %     (s2) edge (s5);
        % \draw[right angle length=1.5ex, right angle symbol={s4}{s5}{p2}];
        % \draw[right angle length=1.5ex, right angle symbol={s4}{s2}{p2}];
        % \draw[right angle length=1.5ex, right angle symbol={s2}{s5}{p2}];

        \draw[extremal edge] (p1) edge node[extremal spheres] {${1, 3}$} ($(p1) + 10*(    -0.6,     0.8)$);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${3, 4}$} ($(p1) + 10*(     0.0,    -1.0)$);
        \draw[internal edge] (p1) edge node[internal spheres, pos=0.2] {${1, 4}$} (p3);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.2] {${4, 5}$} ($(p2) + 10*(    -0.0,    -1.0)$);
        \draw[extremal edge] (p2) edge node[extremal spheres] {${2, 5}$} ($(p2) + 10*(  0.8944,  0.4472)$);
        \draw[internal edge] (p2) edge node[internal spheres, pos=0.5] {${2, 4}$} (p3);
        \draw[extremal edge] (p3) edge node[extremal spheres] {${1, 2}$} ($(p3) + 10*(  0.4472,  0.8944)$);

        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
        \node[point] () at (p3) {};
    \end{tikzpicture}
    \caption{The power diagram of the five sites $\PD(\left\{ s_1, \dots, s_5 \right\})$ is the set of their cells, whose boundaries are shown in the figure. Boundaries are defined by sets of points for which adjacent sites have equal minimizing power.}
    \label{fig:garage}
\end{figure}

\begin{definition}[Power Diagram]
    \label{def:powerdiagram}
    The \define{power diagram} $\PD(S)$ of a finite set of sites $S \subset \R^d \times \R$ is the collection of all \define{cells} corresponding to the sites.
    \begin{align}
        \cell &: S \to \powerset{\R^d}\\
        \cell(s) &\mapsto \left\{ x \in \R^d \mid \forall t \in S \setminus \left\{ s \right\}. \pow(x, s) < \pow(x, t) \right\}\\
        \PD(S) &\coloneqq \cell(S)
    \end{align}
\end{definition}

\Cref{fig:garage} shows an example of a power diagram in two dimensions.
After introducing some geometric notation, the remainder of this section will show some properties of power diagrams in $d$ dimensions.
After this, a transform to $d + 1$ dimension will be used to both show a fundamental connection between power diagrams and polytopes and derive an algorithm to efficiently construct power diagrams of arbitrary dimension using convex hulls.

\subsection{Geometric Notation}
\label{sub:geometric_notation}
\todo[inline]{Affine Spaces, $\aff$}
\todo[inline]{Convex Hull, $\CHb$}
\todo[inline]{Flats, Faces, Facets, $\ldots$}
\todo[inline]{Polyhedra}
\todo[inline]{Lineality Space}
\todo[inline]{Dual Polyhedra}

\subsection{Properties of Power Diagrams}
\label{sub:properties_of_power_diagrams}
The boundaries of a power diagram are given by sets of points for which the power of at least two sites is equal.
Using the definition of the power function, it can be shown that these boundaries are hyperplanes.
\begin{observation}
    \label{obs:chordale}
    Let $s = (z_s, r^2_s)$ and $t = (z_t, r^2_t)$ be spheres in $\R^d$ with $z_s \neq z_t$. The points $x$ for which $\pow(x, s) = \pow(x, t)$ are called the \define{chordale} of $s$ and $t$ and form the hyperplane
    \begin{align}
        \chor(s, t) = \left\{ x \in \R^d \mid 2(z_s - z_t)^Tx = r_t^2 - r_s^2 - z_t^Tz_t + z_s^Tz_s \right\}
    \end{align}
    which is perpendicular to the line connecting $z_s$ and $z_t$.
\end{observation}

The chordal of two concentric spheres is not defined, but can be assumed to be at infinity.
Note that if $r_s = r_t$, the chordal of the two spheres is the bisector of the line connecting $z_s$ and $z_t$.
A power diagram for which all radii are equal is therefore equivalent to the Voronoi diagram of the centers.

The normal vectors of the chordales of three spheres are given by the pairwise differences of their centers.
Since any of these differences can be expressed through the other two, their intersection has higher dimensionality than a general intersection of three hyperplanes has.
\begin{observation}
    Let $s, t$ and $u$ be spheres in $\R^d$ with $d \geq 2$.
    If the spheres are not collinear, the intersection of their chordales $\chor(s,t) \cap \chor(t, u) \cap \chor(u, s)$ is a $(d-2)$-flat.
    If they are collinear, the three chordales are parallel.
    More generally, the chordales of a sphere with $k \leq d$ non-collinear other spheres in $\R^d$ intersect in a $(d-k)$-flat.
\end{observation}

Let $S$ be a finite set of $n$ spheres in $\R^d$ whose centers have an affine dimension of $d$.
Since the cell of every sphere $s \in S$ is bounded by $n - 1$ chordales (which are not necessarily all part of the power diagram), it can be expressed as the intersection of $n - 1$ halfspaces and is therefore a $d$-polyhedron.
$\PD(S)$ partitions $\R^d$ into polyhedra, with the exception of points $x$ on chordals for which there exist at least two $s_i \in S$ which minimize $\pow(x, s)$.

\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[x=0.5cm, y=0.5cm]
        \path[clip, use as bounding box] (-5, -7) rectangle (19, 8);

        \node[sphere center, label={above:$s_5$}] (s1) at (    10.0,     4.0) {};
        \draw[sphere radius] (s1) circle[radius=3.5];
        \node[sphere center, label={right:$s_3$}] (s2) at (    15.0,    -3.0) {};
        \draw[sphere radius] (s2) circle[radius=3.2];
        \node[sphere center, label={left:$s_1$}] (s3) at (     0.0,     0.0) {};
        \draw[sphere radius] (s3) circle[radius=5.0];
        \node[sphere center, label={above:$s_4$}] (s4) at (    13.5,    -3.0) {};
        \draw[sphere radius] (s4) circle[radius=1.3];
        \node[sphere center, label={above:$s_2$}] (s5) at (    1.7,    0) {};
        \draw[sphere radius] (s5) circle[radius=1.5];

        \coordinate (p1) at (   7.408,  -2.425);
        \coordinate (p2) at (    11.4, -0.4293);

        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.3] {${1, 5}$} ($(p1) + 15*( -0.3714,  0.9285)$);
        \draw[extremal edge] (p1) edge node[extremal spheres, pos=0.2] {${1, 4}$} ($(p1) + 15*( -0.2169, -0.9762)$);
        \draw[internal edge] (p1) edge node[internal spheres] {${4, 5}$} (p2);              5
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.3] {${3, 5}$} ($(p2) + 15*(  0.8137,  0.5812)$);
        \draw[extremal edge] (p2) edge node[extremal spheres, pos=0.3] {${3, 4}$} ($(p2) + 15*(    -0.0,    -1.0)$);

        \node[point] () at (p1) {};
        \node[point] () at (p2) {};
    \end{tikzpicture}
    \caption{The cell of site $s_2$ in this two-dimensional power diagram with five sites is empty. This can happen, if the sphere of a site is completely contained in a sphere of an other site. This condition is not sufficient however, since $s_4$ does have a non-empty cell. The center of $s_4$ is not part of its cell however.}
    \label{fig:emptycells}
\end{figure}
\Cref{fig:emptycells} shows that in contrast to Voronoi diagrams, not every sphere must have a non-empty cell in a power diagram.
This can happen, if a sphere completely contained in another sphere, but this is not a sufficient condition.
Being contained in another sphere can also lead to a sphere $s$ having a cell for which $z_s \not\in \cell(s) \neq \varnothing$.

While it is easy to calculate chordales between two spheres, the main question to answer when constructing power diagrams is which chordales actually are tight bounds to a cell and which $j$-faces (for $0 \leq j < d - 1$) exist.
To describe all existing non-extremal faces, one can find all existing $0$-faces and remember which sets of them describe the existing faces of higher dimensionality via their convex hulls.
To justify this approach, the following lemma shows that for power diagrams which have $0$-faces, this approach does not miss internal faces.

\begin{lemma}
    Let $S \subset \R^d$ be a finite set of spheres.
    If any cell of $\PD(S)$ is bounded by a $0$-face, then every cell in $\PD(S)$ is bounded by a $0$-face.
\end{lemma}
\begin{proof}
    Let $S \subset \R^d$ be a finite set of spheres $s_i = (z_i, r_i^2)$ with $\abs{S} \geq d+2$ and $s_1, \dots, s_d, s_{d+1}, s_{d+2} \in S$ such that (the cell of) $s_{d+1}$ shares a $0$-face with $s_1, \dots, s_d$ in $\PD(S)$.
    Since the chordales of $z_{d+1}$ with these sites intersect in a $0$-face, their $d$ normal vectors $\left\{  z_i - z_{d+1} \mid 1 \leq i \leq d\right\}$ must be linearly independent, or equivalently, $\dim(\aff(\left\{ z_1, z_2, \dots, z_{d+1} \right\})) = d$.

    Suppose that $z_{d+2}$ is not bounded by a $0$-face.
    Then, the face of lowest dimension of the polyhedron of $s_{d+2}$ has at least $1$ dimension and must be unbounded, giving the polyhedron a lineality space of dimensionality at least $1$.

    The vectors in this lineality space must be perpendicular to all chordales of $s_{d+2}$, since the polyhedron is bounded by them.
    A subset of the normal vectors of these chordales is the set $C = \left\{ z_i - z_{d+2} \mid 1 \leq i \leq d+1 \right\}$.
    Note that
    \begin{align}
        \dim C = \dim \left( \aff \left( \left\{ z_1, z_2, \dots, z_{d+2} \right\} \right) \right) \geq \dim \left( \aff \left( \left\{ z_1, z_2, \dots, z_{d+1} \right\} \right) \right) = d
    \end{align}
    and therefore, the lineality space can only have dimension $0$, which is a contradiction.
\end{proof}

\section{Embedding in \texorpdfstring{$d+1$}{d+1} Dimensions}
\label{sec:embedding_in_d_1_dimensions}
To derive an algorithm to efficiently compute the cells of power diagrams via the incidence structure of the faces of the boundaries, power diagrams of $d$ dimensions will be embedded into $d+1$ dimensions using a transformation function to map its spheres to hyperplanes.
This will lead to a result identifying these power diagrams with polyhedra in $d+1$ dimensions which can be expressed as the intersection of upper halfspaces.
Using this identity together with a duality mapping for polyhedra will finally connect power diagrams to convex hulls and will be the basis of the algorithm to calculate power diagrams.

\subsection{The Transformation Function}
\label{sub:the_transform}
The embedding of power diagrams in an additional dimension relies on the fact that the power function of a sphere in $\R^d$ can be calculated using distances to a hyperplane in $\R^{d+1}$.

Inspect the space $\R^{d+1}$ and let the original space $\R^d$ be identified with the hyperplane $h_0: x_{d+1} = 0$.
Let $U$ denote the paraboloid $x_{d+1} = x_{[d]}^Tx_{[d]}$ with $x_{[d]} = \left( x_1, \dots, x_d \right)^T$.
\begin{definition}[Transformation Function]
    Let $s = (z, r^2)$ be a $d$-dimensional sphere.
    The \define{transformation function $\Pi$} maps this sphere to the hyperplane
    \begin{align}
        \Pi(s) &\coloneqq \left\{ x \in \R^{d+1} \mid x_{d+1} = 2x_{[d]}^Tz - z^Tz + r^2 \right\}\\
    &= \left\{ x \in \R^{d+1} \mid \left( 2 \cdot z, -1 \right)^T x = z^Tz - r^2 \right\}.
    \end{align}
\end{definition}

This transform has a direct connection to $U$ since
\begin{align}
    \Pi(s) \cap U &= \left\{ x \in \R^{d+1} \mid x_{d+1} = 2x_{[d]}^Tz - z^Tz + r^2 = x_{[d]}^Tx_{[d]} \right\}
\end{align}
where it holds that
\begin{alignat}{2}
    &&2x_{[d]}^Tz_{[d]} - z_{[d]}^Tz_{[d]} + r^2 &= x_{[d]}^Tx_{[d]}\\
    &\Leftrightarrow\quad& \dist(x_{[d]}, z) &= r^2\\
    &\Leftrightarrow\quad& x_{[d]} &\in s.
\end{alignat}
The intersection of $\Pi(s)$ and $U$ is therefore the vertical projection of $s$ onto $U$.
The following proofs that this mapping is an identification of the two concepts.
\begin{lemma}
    \label{lem:pibijection}
    $\Pi$ is a bijection between spheres in $h_0$ and hyperplanes in $\R^{d+1}$ which are not parallel to the $x_{d+1}$ axis and intersect $U$.
\end{lemma}
\begin{proof}
    $\Pi$ is clearly injective since $z$ directly influences the normal vector and for two concentric spheres to have the same offset, $r$ must be equal.
    $\Pi$ is also surjective if every intersection of hyperplane which is not parallel to $x_{d+1}$ with $U$ is an ellipsoid which results in a sphere if projected to $h_0$.

    Let $n \in \R^{d+1}$ be a normal vector with $n_{d+1} = 1$, let $b \in \R$ be an offset and $h = \left\{ y \in \R^{d+1} \mid n^T y = b \right\}$ a hyperplane in $\R^{d+1}$ which is not parallel to the $x_{d+1}$ axis.
    The projection to $h_0$ of the intersection of $h$ with $U$ is given by
    \begin{align}
        h \cap U = \left\{ x \in \R^{d+1} \mid x_{d+1} = b - n_{[d]}^T x_{[d]} = x_{[d]}^T x_{[d]} \right\}
    \end{align}
    where
    \begin{alignat}{2}
        &&b - n_{[d]}^Tx_{[d]} &= x_{[d]}^Tx_{[d]}\\
        &\Leftrightarrow\quad& x_{[d]}^Tx_{[d]} + n_{[d]}^Tx_{[d]} - b &= 0.
    \end{alignat}

    To show that this projection is actually a sphere, it should be described by a center $v \in \R^d$ and a radius $\alpha \geq 0$ in the equation
    \begin{alignat}{2}
        &&\dist(x_{[d]},v)^2 &= \alpha.
        \intertext{Now let $\alpha = b + \frac{1}{4} n_{[d]}^Tn_{[d]}$ and $v = \frac{1}{2}n_{[d]}$. Then}
        &&\dist(x_{[d]},\frac{1}{2}n_{[d]})^2 &= b + \frac{1}{4} n_{[d]}^Tn_{[d]}\\
        &\Leftrightarrow\quad&x_{[d]}^Tx_{[d]} - n_{[d]}^Tx_{[d]} + \frac{1}{4} n_{[d]}^Tn_{[d]} &= b + \frac{1}{4} n_{[d]}^Tn_{[d]}\\
        &\Leftrightarrow\quad& x_{[d]}^Tx_{[d]} + n_{[d]}^Tx_{[d]} - b &= 0
    \end{alignat}
    so the projection of the intersection is indeed a sphere if $b > -\frac{1}{4}n_{[d]}^Tn_{[d]}$, a point if $b = -\frac{1}{4}n_{[d]}^Tn_{[d]}$ and $h$ does not intersect $U$ otherwise.
\end{proof}

$\Pi(s)$ being the vertical projection of spheres to $U$ can also be used to compute the power of some point with respect to $s$.
\begin{observation}
    \label{obs:distances}
    Let $s = (z, r^2)$ be a sphere in $h_0$ and $x \in h_0$.
    Let $x^\prime$ and $x^{\prime\prime}$ denote the vertical projections of $x$ onto $U$ and $\Pi(s)$. It then holds that
    \begin{align}
        \pow(x_{[d]}, s) = \dist(x, x^\prime) - \dist(x, x^{\prime\prime})
    \end{align}
\end{observation}
\begin{proof}
    Since the projections of $x$ did not change the first $d$ coordinates, it holds that $\dist(x, x^\prime) = x_{[d]}^Tx_{[d]}$ and $\dist(x, x^{\prime\prime}) = 2x_{[d]}^Tz - z^Tz + r^2$, with their difference being $(x_{[d]} - z)^T(x_{[d]} - z) - r^2 = \pow(x_{[d]}, s)$.
\end{proof}

This directly implies the following lemma, which connects chordales to the newly formed hyperplanes by recognizing that the intersection of two hyperplanes in $\R^{d+1}$ contains projected points with the same power value for the respective spheres.

\begin{lemma}
    \label{lem:verticalprojection}
    Let $s$ and $t$ be non-cocentric spheres in $h_0$.
    Then $\chor(s, t)$ is the vertical projection of $\Pi(s) \cap \Pi(t)$ onto $h_0$.
\end{lemma}
\missingfigure{3D Figure showing the Paraboloid and Planes intersecting.}

\subsection{Duality of points and hyperplanes}
\label{sub:duality_of_points_and_hyperplanes}
The hyperplanes established with the mapping $\Pi$ will now be connected to specific \define{polar points} to establish a bijective mapping between $j$-flats defined by the intersection of hyperplanes and $(d-j)$-flats in this dual domain.

\begin{definition}[Polarity Function]
    Let $a \in \R^{d}$ and $a_{d+1} \in \R$.
    The \define{polarity function $\Delta$} maps the hyperplane $h = \left\{ x \in \R^{d+1} \mid x_{d+1} = a^Tx_{[d]} + a_{d+1} \right\}$ not parallel to the $x_{d+1}$ axis to the point
    \begin{align}
        \Delta(h) &\coloneqq \begin{pmatrix} \frac{1}{2} a \\ -a_{d+1} \end{pmatrix}  \in \R^{d+1}
        \intertext{and any face $f \subseteq \R^{d+1}$ to}
        \Delta(f) &\coloneqq \bigcup_{\substack{f \subseteq h\\h \textnormal{ hyperplane}}} \Delta(h).
    \end{align}
\end{definition}

Let $h$ be a hyperplane in $\R^{d+1}$ and $p \in \R^{d+1}$. The images $\Delta(h)$ and $\Delta(p)$ are called \define{pole} and \define{polar hyperplane} respectively.
The following lemma shows a fundamental property of $\Delta$ on points and hyperplanes and connects flats of other dimensionality.
\begin{lemma}
    \label{lem:deltainvolutory}
    $\Delta$ is an involutory function and a bijection between $j$-flats and $(d-j)$-flats in $\R^{d+1}$ (for $0 \leq j \leq d$).
\end{lemma}
\begin{proof}
    Let $F = f + X \subset \R^{d+1}$ be some flat with $f \in \R^{d+1}$, $\dim(X) = j$ ($0 \leq j \leq d$) and
    \begin{align}
        X^\bot = \left\{ n \in \R^{d+1} \mid \forall x \in X. \scalar{n, x} = 0 \right\}
    \end{align}
    the set of all vectors perpendicular to $X$ for which $\dim(X^\bot) = d - j + 1$.
    Then all hyperplanes containing $F$ have a normal vector which is in $X^\bot$.
    Let $n \in X^\bot$ and
    \begin{align}
        h(n) &= \left\{x \in \R^{d+1} \mid \scalar{n, x - f} = 0\right\}\\
        &= \left\{ x \in \R^{d+1} \mid n_{d+1} \cdot x_{d+1} = -n_{[d]}^Tx_{[d]} + n^Tf \right\}
    \end{align}
    its corresponding hyperplane containing $F$.
    Then let \Wlog \todo{Es gibt in der Argumentation Probleme mit senkrechten Ebenen (für die $\Delta$ nicht definiert ist) und mit dem Nullpunkt bzw $h_0$.}$N = \left\{ n \in X^\bot \mid n_{d+1} = 1 \right\}$ the set of all possible normal vectors and
    \begin{align}
        \Delta(F) &= \Delta(h(N))\\
        &= \bigcup_{n \in N} \Delta(h(n)) \\
        &= \bigcup_{n \in N} \Delta \left( \left\{ x \in \R^{d+1} \mid x_{d+1} = -n_{[d]}^Tx_{[d]} + n^Tf \right\} \right) \\
        &= \bigcup_{n \in N} \begin{pmatrix} -\frac{1}{2} n_{[d]}\\ - n^T f \end{pmatrix}
    \end{align}
    $\Delta(F)$ is then a $(d - j)$-flat which is the result of removing the last dimension of the $(d - j + 1)$-flat $F$ and an affine transformation.
    It is defined by the affine hull of the polar points of $h(n_i)$ for any suitable basis $\left\{ n_1, \dots, n_{d - j + 1} \right\}$ of $X^\bot$.

    $\Delta$ is surjective since for any $(d - j$)-flat which is the affine hull of points $\left\{ f_1, \dots, f_{d - j + 1} \right\}$ one can find suitable $n_i$ to form a basis of the orthogonal space and an $f$ to define a $j$-flat which is its preimage.

    Suppose $F = p + \left\{ 0 \right\}$ is a $0$-flat.
    Then $\left\{ 0 \right\}^\bot = \R^{d+1}$ and
    \begin{align}
        \Delta(F) &= \bigcup_{\substack{n \in \R^{d+1}\\n_{d+1} = 1}} \begin{pmatrix} -\frac{1}{2} n_{[d]}\\ -n^T p \end{pmatrix} \\
        &= \left\{ x \in \R^{d+1} \mid x_{d+1} = 2 \cdot p_{[d]}^Tx_{[d]} - p_{d+1} \right\}
    \end{align}
    is a hyperplane, for which $\Delta(\Delta(F)) = p$, which proves that $\Delta$ is involutory.
    Together with the surjetiveness for faces, the bijectiveness of $\Delta$ follows.
\end{proof}

An additional property of $\Delta$ is its preservation of relative positions of points and hyperplanes.
\begin{lemma}
    \label{lem:relativepositions}
    Let $p \in \R^{d+1}$ and $h$ a hyperplane in $\R^{d+1}$.
    Then $p$ is above, in or below $h$ exactly if $\Delta(h)$ is above, in or below $\Delta(p)$ respectively.
\end{lemma}
\begin{proof}
    Let $x,n \in \R^{d+1}$ and $h = \left\{ y \in \R^{d+1} \mid y_{d+1} = n_{[d]}^Ty_{[d]} + n_{d+1} \right\}$ a hyperplane in $\R^{d+1}$.
    Then by definition and \cref{lem:deltainvolutory}
    \begin{align}
        \Delta(h) &\coloneqq \begin{pmatrix} \frac{1}{2} n \\ -n_{d+1} \end{pmatrix}  \in \R^{d+1}\\
        \Delta(p) &= \left\{ y \in \R^{d+1} \mid y_{d+1} = 2x_{[d]}^Ty_{[d]} - x_{d+1} \right\}
    \end{align}
    Any point $y \in \R^{d+1}$ is above $\Delta{p}$ if
    \begin{align}
        2x_{[d]}^Ty_{[d]} - y_{d+1} - x_{d+1} > 0
    \end{align}
    and on or below the hyperplane when it is equal or smaller.
    Inserting $\Delta(h)$ into the equation yields
    \begin{align}
        2x_{[d]}^T \left( \frac{1}{2}n_{[d]} \right) + n_{d+1} - x_{d+1} = n_{[d]}^Tx_{[d]} - x_{d+1} + n_{d+1}
    \end{align}
    which is equal to the expression determining the relative position of $x$ to $h$.
\end{proof}

\subsection{Power Diagrams and Polyhedra}
\label{sub:power_diagrams_and_polyhedra}
Having established the bijectivity of $\Pi$ it can be shown that power diagrams in $\R^d$ can be identified with boundaries of $(d+1)$-polyhedra.
\begin{theorem}
    \label{thm:equivalentpolyhedron}
    For any $(d+1)$-polyhedron P which is expressible as the intersection of halfspaces pointing upwards, there exists an affinely equivalent power diagram in $h_0$ and vice versa.
\end{theorem}
\begin{proof}
    Let $P = \bigcap_{i=1}^n h_i^+$ of hyperplanes $h_i$ with normal vectors with positive $(d+1)$st coordinates such that for facet $f_i$ of $P$ it holds that $f_i \subseteq h_i$.
    Also assume that $h_i \cup U \neq h_i$ for all $i$ which can be achieved by moving the polyhedron in $x_{d+1}$-direction.

    \Cref{lem:pibijection} implies that there is a set $S = \left\{ s_1, \dots, s_n \right\}$ of spheres in $h_0$ such that $\Pi(s_i) = h_i$.
    Using \cref{obs:distances} it holds that the vertical projection of any $x \in h_0$ onto $P$ is in $f_i$ (and therefore $h_i$) exactly if $x \in \cell(s_i)$ is in $\PD(S)$.
    This means that $\cell(s_i)$ is exactly the vertical projection of $f_i$ onto $h_0$ for all $1 \leq i \leq n$, giving that $\PD(S)$ is affinely equivalent to $P$.

    Conversely, given any set of spheres $S$ in $h_0$ a corresponding polyhedron can be constructed by intersecting the upper halfspaces of the hyperplanes in $\Pi(S)$.
\end{proof}
To also describe polyhedra $P$ generated using the intersection of upper halfspaces, one can inspect the reflection of $P$ through $h_0$ as described in \cite{aurenhammer1987power}.

Having established the existence of an affinely equivalent polyhedron for each set of spheres in $h_0$, the following theorem will show that using the polarity function $\Gamma$, it is possible to relate power diagrams to convex hulls.
Remember that a convex hull splits into its top and bottom part given by the sign of the $(d+1)$st component of the normal vector, where vertical facets are assigned to neither parts.
\begin{theorem}
    \label{thm:equivalentconvexhull}
    For \todo{Hier muss man glaube ich einschränken auf $M$ sodass $\Delta(M)$ nur Hyperebenen enthält, die $U$ schneiden.}any finite set $M \subset \R^{d+1}$ there exists a set $S$ of spheres in $h_0$ such that $\PD(S)$ is dual to $\CHb(M)$.
\end{theorem}
\begin{proof}
    By \cref{thm:equivalentpolyhedron} there exists an affinely equivalent polyhedron $P$ for each $\PD(S)$ in $h_0$ which is defined by the intersection of the upper halfspaces of the hyperplanes $H = \left\{ h_1, \dots, h_n \mid h_i = \Pi(s_i) \right\}$ and vice versa.
    Let $M = \Delta(H)$ the set of all polars of the hyperplanes corresponding to all spheres, then $\CHb(M)$ will be dual to $P$.

    Let $f_i$ be the facet associated with $h_i$ (see the proof of \cref{thm:equivalentpolyhedron}) and let $p_i = \Delta(h_i)$.
    Let also $f_i$ and $f_j$ be adjacent in a $(d-1)$-face $g$ ($1 \leq i < j \leq n$).
    Then every $x \in g$ is in $h_i \cap h_j$ and above each $h \in H \setminus \left\{ h_i, h_j \right\}$ via \cref{obs:distances}.

    \Cref{lem:relativepositions} now implies that exactly then $p_i, p_j \in \Delta(x)$ and every other point $p \in M \setminus \left\{ p_i, p_j \right\}$ is above $\Delta(x)$.
    The line defined by $p_i$ and $p_j$, which is $\Delta(g)$, therefore defines an edge of $\CHb(M)$.
    Since a similar argument holds for all other $j$-faces, $P$ is dual to $\CHb(M)$ and therefore, $\PD(S)$ is, too.
\end{proof}
\section{Constructing Power Diagrams}
\label{sec:constructing_power_diagrams}
\subsection{Naive Algorithm}
\label{sub:naive_algorithm}
\todo[inline]{Combinatorical tries with brute force}

\subsection{The Algorithm}
\label{sub:the_algorithm}
\todo[inline]{3-Step-Algorithm}
\todo[inline]{Running Time (fairly trivial)}
\todo[inline]{Convex Hulls?}

\subsection{Incidence Lattices}
\label{sub:incidence_lattices}
\todo[inline]{Model as Bidirectional Graph}
\todo[inline]{Adding Faces to the Lattice is fun - Lubs and Groups}

\appendix
\section{Building the Code}
\label{sec:building_the_code}
\todo[inline]{Libraries}
\todo[inline]{Make, CMake}
\todo[inline]{Windows...}

\nocite{*}
\bibliographystyle{alpha}
\bibliography{powerdiagrams}
\end{document}
